{"version":3,"file":"d3plus-viz.js","sources":["../src/data/concat.js","../src/data/isData.js","../src/data/fold.js","../src/data/load.js","../src/data/addToQueue.js","../src/Message.js","../src/_drawBack.js","../src/_drawColorScale.js","../src/_drawLegend.js","../src/_drawTimeline.js","../src/_drawTitle.js","../src/_drawTotal.js","../src/_getSize.js","../src/_inViewport.js","../src/on/click.shape.js","../src/on/click.legend.js","../src/on/mouseenter.js","../src/on/mouseleave.js","../src/on/mousemove.legend.js","../src/on/mousemove.shape.js","../src/on/touchstart.body.js","../src/_zoomControls.js","../src/_drawAttribution.js","../src/Viz.js"],"sourcesContent":["/**\n  @function dataConcat\n  @desc Reduce and concat all the elements included in arrayOfArrays if they are arrays. If it is a JSON object try to concat the array under given key data. If the key doesn't exists in object item, a warning message is lauched to the console. You need to implement DataFormat callback to concat the arrays manually.\n  @param {Array} arrayOfArray Array of elements\n  @param {String} [data = \"data\"] The key used for the flat data array if exists inside of the JSON object.\n*/\nexport default (arrayOfArrays, data = \"data\") =>\n  arrayOfArrays.reduce((acc, item) => {\n    let dataArray = [];\n    if (Array.isArray(item)) {\n      dataArray = item;\n    }\n    else {\n      if (item[data]) {\n        dataArray = item[data];\n      }\n      else {\n        console.warn(`d3plus-viz: Please implement a \\\"dataFormat\\\" callback to concat the arrays manually (consider using the d3plus.dataConcat method in your callback). Currently unable to concatenate (using key: \\\"${data}\\\") the following response:`, item);\n      }\n    }\n    return acc.concat(dataArray);\n  }, []);\n\n","/**\n  @function isData\n  @desc Returns true/false whether the argument provided to the function should be loaded using an internal XHR request. Valid data can either be a string URL or an Object with \"url\" and \"headers\" keys.\n  @param {*} dataItem The value to be tested\n*/\nexport default dataItem =>\n  typeof dataItem === \"string\" ||\n  typeof dataItem === \"object\" && dataItem.url && dataItem.headers;\n","/**\n  @function dataFold\n  @desc Given a JSON object where the data values and headers have been split into separate key lookups, this function will combine the data values with the headers and returns one large array of objects.\n  @param {Object} json A JSON data Object with `data` and `headers` keys.\n  @param {String} [data = \"data\"] The key used for the flat data array inside of the JSON object.\n  @param {String} [headers = \"headers\"] The key used for the flat headers array inside of the JSON object.\n*/\nexport default (json, data = \"data\", headers = \"headers\") =>\n  json[data].map(data =>\n    json[headers].reduce((obj, header, i) =>\n      (obj[header] = data[i], obj), {}));\n","import {csv, json, text, tsv} from \"d3-request\";\nimport fold from \"./fold\";\nimport concat from \"./concat\";\nimport isData from \"./isData.js\";\nimport {isObject} from \"d3plus-common\";\n\n/**\n  @function dataLoad\n  @desc Loads data from a filepath or URL, converts it to a valid JSON object, and returns it to a callback function.\n  @param {Array|String} path The path to the file or url to be loaded. Also support array of paths strings. If an Array of objects is passed, the xhr request logic is skipped.\n  @param {Function} [formatter] An optional formatter function that is run on the loaded data.\n  @param {String} [key] The key in the `this` context to save the resulting data to.\n  @param {Function} [callback] A function that is called when the final data is loaded. It is passed 2 variables, any error present and the data loaded.\n*/\nexport default function(path, formatter, key, callback) {\n\n  let parser;\n\n  const getParser = path => {\n    const ext = path.slice(path.length - 4);\n    switch (ext) {\n      case \".csv\":\n        return csv;\n      case \".tsv\":\n        return tsv;\n      case \".txt\":\n        return text;\n      default:\n        return json;\n    }\n  };\n\n  const validateData = (err, parser, data) => {\n    if (parser !== json && !err && data && data instanceof Array) {\n      data.forEach(d => {\n        for (const k in d) {\n          if (!isNaN(d[k])) d[k] = parseFloat(d[k]);\n          else if (d[k].toLowerCase() === \"false\") d[k] = false;\n          else if (d[k].toLowerCase() === \"true\") d[k] = true;\n          else if (d[k].toLowerCase() === \"null\") d[k] = null;\n          else if (d[k].toLowerCase() === \"undefined\") d[k] = undefined;\n        }\n      });\n    }\n    return data;\n  };\n\n  const loadedLength = loadedArray => loadedArray.reduce((prev, current) => current ? prev + 1 : prev, 0);\n\n  const getPathIndex = (url, array) => array.indexOf(url);\n\n  // If path param is a not an Array then convert path to a 1 element Array to re-use logic\n  if (!(path instanceof Array)) path = [path];\n\n  const needToLoad = path.find(isData);\n\n  let loaded = new Array(path.length);\n  const toLoad = [];\n\n  // If there is a string I'm assuming is a Array to merge, urls or data\n  if (needToLoad) {\n    path.forEach((dataItem, ix) => {\n      if (isData(dataItem)) toLoad.push(dataItem);\n      else loaded[ix] = dataItem;\n    });\n  }\n  // Data array itself\n  else {\n    loaded[0] = path;\n  }\n\n  // Load all urls an combine them with data arrays\n  const alreadyLoaded = loadedLength(loaded);\n  toLoad.forEach(dataItem => {\n    let headers = {}, url = dataItem;\n    if (typeof dataItem === \"object\") {\n      url = dataItem.url;\n      headers = dataItem.headers;\n    }\n    parser = getParser(url);\n    const request = parser(url);\n    for (const key in headers) {\n      if ({}.hasOwnProperty.call(headers, key)) {\n        request.header(key, headers[key]);\n      }\n    }\n    request.get((err, data) => {\n      data = err ? [] : data;\n      if (data && !(data instanceof Array) && data.data && data.headers) data = fold(data);\n      data = validateData(err, parser, data);\n      loaded[getPathIndex(url, path)] = data;\n      if (loadedLength(loaded) - alreadyLoaded === toLoad.length) { // All urls loaded\n\n        // Format data\n        data = loadedLength(loaded) === 1 ? loaded[0] : loaded;\n        if (this._cache) this._lrucache.set(`${key}_${url}`, data);\n\n        if (formatter) {\n          const formatterResponse = formatter(loadedLength(loaded) === 1 ? loaded[0] : loaded);\n          if (key === \"data\" && isObject(formatterResponse)) {\n            data = formatterResponse.data || [];\n            delete formatterResponse.data;\n            this.config(formatterResponse);\n          }\n          else data = formatterResponse || [];\n        }\n        else if (key === \"data\") {\n          data = concat(loaded, \"data\");\n        }\n\n        if (key && `_${key}` in this) this[`_${key}`] = data;\n        if (callback) callback(err, data);\n      }\n    });\n  });\n\n  // If there is no data to Load response is immediately\n  if (toLoad.length === 0) {\n    loaded = loaded.map(data => {\n      if (data && !(data instanceof Array) && data.data && data.headers) data = fold(data);\n      return data;\n    });\n\n    // Format data\n    let data = loadedLength(loaded) === 1 ? loaded[0] : loaded;\n    if (formatter) {\n      const formatterResponse = formatter(loadedLength(loaded) === 1 ? loaded[0] : loaded);\n      if (key === \"data\" && isObject(formatterResponse)) {\n        data = formatterResponse.data || [];\n        delete formatterResponse.data;\n        this.config(formatterResponse);\n      }\n      else data = formatterResponse || [];\n    }\n    else if (key === \"data\") {\n      data = concat(loaded, \"data\");\n    }\n\n    if (key && `_${key}` in this) this[`_${key}`] = data;\n    if (callback) callback(null, data);\n  }\n\n}\n","import isData from \"./isData.js\";\nimport load from \"./load.js\";\n\n/**\n  @function isData\n  @desc Adds the provided value to the internal queue to be loaded, if necessary. This is used internally in new d3plus visualizations that fold in additional data sources, like the nodes and links of Network or the topojson of Geomap.\n  @param {Array|String|Object} data The data to be loaded\n  @param {Function} [data] An optional data formatter/callback\n  @param {String} data The internal Viz method to be modified\n*/\nexport default function(_, f, key) {\n  if (!(_ instanceof Array)) _ = [_];\n  const needToLoad = _.find(isData);\n  if (needToLoad) {\n    const prev = this._queue.find(q => q[3] === key);\n    const d = [load.bind(this), _, f, key];\n    if (prev) this._queue[this._queue.indexOf(prev)] = d;\n    else this._queue.push(d);\n  }\n  else {\n    this[`_${key}`] = _;\n  }\n}\n","import {select} from \"d3-selection\";\n\nimport {stylize} from \"d3plus-common\";\n\n/**\n    @class Message\n    @desc Displays a message using plain HTML.\n    @private\n*/\nexport default class Message {\n\n  /**\n      @memberof Message\n      @desc Invoked when creating a new class instance, and sets any default parameters.\n      @private\n  */\n  constructor() {\n    this._isVisible = false;\n  }\n\n  /**\n      @memberof Message\n      @desc Removes the message from the page.\n      @chainable\n  */\n  exit(elem, duration) {\n\n    elem\n      .transition().duration(duration).style(\"opacity\", 0)\n      .transition().remove();\n\n    this._isVisible = false;\n\n  }\n\n  /**\n      @memberof Message\n      @desc Removes the message from the page.\n      @chainable\n  */\n  hide({duration = 600, callback} = {}) {\n\n    this.mask.call(this.exit.bind(this), duration);\n    this.elem.call(this.exit.bind(this), duration);\n\n    if (callback) setTimeout(callback, duration + 100);\n\n    this._isVisible = false;\n\n    return this;\n\n  }\n\n  /**\n      @memberof Message\n      @desc Draws the message given the specified configuration.\n      @param {Object} [*config*]\n      @chainable\n  */\n  render({\n    callback,\n    container = \"body\",\n    duration = 600,\n    html = \"Please Wait\",\n    mask = \"rgba(0, 0, 0, 0.05)\",\n    style = {}\n  } = {}) {\n\n    const parent = select(container);\n\n    this.mask = parent.selectAll(\"div.d3plus-Mask\").data(mask ? [mask] : []);\n\n    this.mask = this.mask.enter().append(\"div\")\n      .attr(\"class\", \"d3plus-Mask\")\n      .style(\"opacity\", 1)\n      .merge(this.mask);\n\n    this.mask.exit().call(this.exit.bind(this), duration);\n\n    stylize(this.mask, {\n      \"background-color\": String,\n      \"bottom\": \"0px\",\n      \"left\": \"0px\",\n      \"position\": \"absolute\",\n      \"right\": \"0px\",\n      \"top\": \"0px\"\n    });\n\n    this.elem = parent.selectAll(\"div.d3plus-Message\").data([html]);\n\n    this.elem = this.elem.enter().append(\"div\")\n      .attr(\"class\", \"d3plus-Message\")\n      .style(\"opacity\", 1)\n      .merge(this.elem)\n      .html(String);\n\n    stylize(this.elem, style);\n\n    if (callback) setTimeout(callback, 100);\n\n    this._isVisible = true;\n\n    return this;\n\n  }\n\n}\n","import {elem} from \"d3plus-common\";\n\n/**\n    @function _drawBack\n    @desc Draws a back button if there are states in this._history.\n    @private\n*/\nexport default function() {\n\n  const visible = this._history.length;\n\n  const backGroup = elem(\"g.d3plus-viz-back\", {\n    parent: this._select,\n    duration: this._duration,\n    update: {transform: `translate(${this._margin.left}, ${this._margin.top})`}\n  }).node();\n\n  this._backClass\n    .data(visible ? [{text: `← ${this._translate(\"Back\")}`, x: 0, y: 0}] : [])\n    .select(backGroup)\n    .config(this._backConfig)\n    .render();\n\n  this._margin.top += visible ? this._backClass.fontSize()() + this._backClass.padding()() * 2 : 0;\n\n}\n","import {min} from \"d3-array\";\nimport {elem} from \"d3plus-common\";\n\n/**\n    @function _drawColorScale\n    @desc Renders the color scale if this._colorScale is not falsey.\n    @private\n*/\nexport default function() {\n\n  const data = this._data;\n\n  let position = this._colorScalePosition.bind(this)(this.config());\n  if (![false, \"top\", \"bottom\", \"left\", \"right\"].includes(position)) position = \"bottom\";\n  const wide = [\"top\", \"bottom\"].includes(position);\n  const padding = this._colorScalePadding() ? this._padding : {top: 0, right: 0, bottom: 0, left: 0};\n\n  const availableWidth = this._width - (this._margin.left + this._margin.right + padding.left + padding.right);\n\n  const width = wide\n    ? min([this._colorScaleMaxSize, availableWidth])\n    : this._width - (this._margin.left + this._margin.right);\n\n  const availableHeight = this._height - (this._margin.bottom + this._margin.top + padding.bottom + padding.top);\n\n  const height = !wide\n    ? min([this._colorScaleMaxSize, availableHeight])\n    : this._height - (this._margin.bottom + this._margin.top);\n\n  const transform = {\n    opacity: position ? 1 : 0,\n    transform: `translate(${wide ? this._margin.left + padding.left + (availableWidth - width) / 2 : this._margin.left}, ${wide ? this._margin.top : this._margin.top + padding.top + (availableHeight - height) / 2})`\n  };\n\n  const showColorScale = this._colorScale && data && data.length > 1;\n\n  const scaleGroup = elem(\"g.d3plus-viz-colorScale\", {\n    condition: showColorScale && !this._colorScaleConfig.select,\n    enter: transform,\n    parent: this._select,\n    duration: this._duration,\n    update: transform\n  }).node();\n\n  if (showColorScale) {\n    const scaleData = data.filter((d, i) => {\n      const c = this._colorScale(d, i);\n      return c !== undefined && c !== null;\n    });\n\n    this._colorScaleClass\n      .align({bottom: \"end\", left: \"start\", right: \"end\", top: \"start\"}[position] || \"bottom\")\n      .duration(this._duration)\n      .data(scaleData)\n      .height(height)\n      .locale(this._locale)\n      .orient(position)\n      .select(scaleGroup)\n      .value(this._colorScale)\n      .width(width)\n      .config(this._colorScaleConfig)\n      .render();\n\n    const scaleBounds = this._colorScaleClass.outerBounds();\n    if (position && !this._colorScaleConfig.select && scaleBounds.height) {\n      if (wide) this._margin[position] += scaleBounds.height + this._legendClass.padding() * 2;\n      else this._margin[position] += scaleBounds.width + this._legendClass.padding() * 2;\n    }\n\n  }\n  else {\n    this._colorScaleClass.config(this._colorScaleConfig);\n  }\n\n\n\n}\n","import {rollup} from \"d3-array\";\nimport {configPrep, elem, merge} from \"d3plus-common\";\n\n/**\n    @function legendLabel\n    @desc Default label function for the legend.\n    @private\n*/\nexport function legendLabel(d, i) {\n  return this._drawLabel(d, i, this._legendDepth);\n}\n\n/**\n    @function _drawLegend\n    @desc Renders the legend if this._legend is not falsy.\n    @param {Array} data The filtered data array to be displayed.\n    @private\n*/\nexport default function(data = []) {\n\n  const legendData = [];\n\n  const color = (d, i) => {\n    const shape = this._shape(d, i);\n    const attr = shape === \"Line\" ? \"stroke\" : \"fill\";\n    const value = this._shapeConfig[shape] && this._shapeConfig[shape][attr]\n      ? this._shapeConfig[shape][attr] : this._shapeConfig[attr];\n    return typeof value === \"function\" ? value.bind(this)(d, i) : value;\n  };\n\n  const opacity = (d, i) => {\n    const shape = this._shape(d, i);\n    const value = this._shapeConfig[shape] && this._shapeConfig[shape].opacity\n      ? this._shapeConfig[shape].opacity : this._shapeConfig.opacity;\n    return typeof value === \"function\" ? value.bind(this)(d, i) : value;\n  };\n\n  const fill = (d, i) => `${ color(d, i) }_${ opacity(d, i) }`;\n\n  const rollupData = this._colorScale ? data.filter((d, i) => this._colorScale(d, i) === undefined) : data;\n  rollup(rollupData, leaves => legendData.push(merge(leaves, this._aggs)), fill);\n\n  legendData.sort(this._legendSort);\n\n  const labels = legendData.map((d, i) => this._ids(d, i).slice(0, this._drawDepth + 1));\n  this._legendDepth = 0;\n  for (let x = 0; x <= this._drawDepth; x++) {\n    const values = labels.map(l => l[x]);\n    if (!values.some(v => v instanceof Array) && Array.from(new Set(values)).length === legendData.length) {\n      this._legendDepth = x;\n      break;\n    }\n  }\n\n  const hidden = (d, i) => {\n    let id = this._id(d, i);\n    if (id instanceof Array) id = id[0];\n    return this._hidden.includes(id) || this._solo.length && !this._solo.includes(id);\n  };\n\n  const legendBounds = this._legendClass.outerBounds();\n  const config = this.config();\n  let position = this._legendPosition.bind(this)(config);\n  if (![false, \"top\", \"bottom\", \"left\", \"right\"].includes(position)) position = \"bottom\";\n  const wide = [\"top\", \"bottom\"].includes(position);\n  const padding = this._legendPadding() ? this._padding : {top: 0, right: 0, bottom: 0, left: 0};\n  const transform = {transform: `translate(${wide ? this._margin.left + padding.left : this._margin.left}, ${wide ? this._margin.top : this._margin.top + padding.top})`};\n  const visible = this._legend.bind(this)(config, legendData);\n\n  const legendGroup = elem(\"g.d3plus-viz-legend\", {\n    condition: visible && !this._legendConfig.select,\n    enter: transform,\n    parent: this._select,\n    duration: this._duration,\n    update: transform\n  }).node();\n\n  this._legendClass\n    .id(fill)\n    .align(wide ? \"center\" : position)\n    .direction(wide ? \"row\" : \"column\")\n    .duration(this._duration)\n    .data(visible ? legendData : [])\n    .height(wide ? this._height - (this._margin.bottom + this._margin.top) : this._height - (this._margin.bottom + this._margin.top + padding.bottom + padding.top))\n    .locale(this._locale)\n    .parent(this)\n    .select(legendGroup)\n    .verticalAlign(!wide ? \"middle\" : position)\n    .width(wide ? this._width - (this._margin.left + this._margin.right + padding.left + padding.right) : this._width - (this._margin.left + this._margin.right))\n    .shapeConfig(configPrep.bind(this)(this._shapeConfig, \"legend\"))\n    .shapeConfig({\n      fill: (d, i) => hidden(d, i) ? this._hiddenColor(d, i) : color(d, i),\n      labelConfig: {\n        fontOpacity: (d, i) => hidden(d, i) ? this._hiddenOpacity(d, i) : 1\n      },\n      opacity\n    })\n    .config(this._legendConfig)\n    .render();\n\n  if (!this._legendConfig.select && legendBounds.height) {\n    if (wide) this._margin[position] += legendBounds.height + this._legendClass.padding() * 2;\n    else this._margin[position] += legendBounds.width + this._legendClass.padding() * 2;\n  }\n\n}\n","import {extent} from \"d3-array\";\n\nimport {date} from \"d3plus-axis\";\nimport {elem, unique} from \"d3plus-common\";\n\n/**\n    @function setTimeFilter\n    @desc Determines whether or not to update the timeFilter method of the Viz.\n    @param {Array|Date} The timeline selection given from the d3 brush.\n    @private\n*/\nfunction setTimeFilter(s) {\n  if (!(s instanceof Array)) s = [s, s];\n  if (JSON.stringify(s) !== JSON.stringify(this._timelineSelection)) {\n    this._timelineSelection = s;\n    s = s.map(Number);\n    this.timeFilter(d => {\n      const ms = date(this._time(d)).getTime();\n      return ms >= s[0] && ms <= s[1];\n    }).render();\n  }\n}\n\n/**\n    @function _drawTimeline\n    @desc Renders the timeline if this._time and this._timeline are not falsy and there are more than 1 tick available.\n    @param {Array} data The filtered data array to be displayed.\n    @private\n*/\nexport default function(data = []) {\n\n  let timelinePossible = this._time && this._timeline;\n  const ticks = timelinePossible ? unique(this._data.map(this._time)).map(date) : [];\n  timelinePossible = timelinePossible && ticks.length > 1;\n  const padding = this._timelinePadding() ? this._padding : {top: 0, right: 0, bottom: 0, left: 0};\n\n  const transform = {transform: `translate(${this._margin.left + padding.left}, 0)`};\n\n  const timelineGroup = elem(\"g.d3plus-viz-timeline\", {\n    condition: timelinePossible,\n    enter: transform,\n    parent: this._select,\n    duration: this._duration,\n    update: transform\n  }).node();\n\n  if (timelinePossible) {\n\n    const timeline = this._timelineClass\n      .domain(extent(ticks))\n      .duration(this._duration)\n      .height(this._height - this._margin.bottom)\n      .locale(this._locale)\n      .select(timelineGroup)\n      .ticks(ticks.sort((a, b) => +a - +b))\n      .width(this._width - (this._margin.left + this._margin.right + padding.left + padding.right));\n\n    if (timeline.selection() === undefined) {\n      this._timelineSelection = extent(data, this._time).map(date);\n      timeline.selection(this._timelineSelection);\n    }\n\n    const config = this._timelineConfig;\n\n    timeline\n      .config(config)\n      // .on(\"brush\", s => {\n      //   setTimeFilter.bind(this)(s);\n      //   if (config.on && config.on.brush) config.on.brush(s);\n      // })\n      .on(\"end\", s => {\n        setTimeFilter.bind(this)(s);\n        if (config.on && config.on.end) config.on.end(s);\n      })\n      .render();\n\n    this._margin.bottom += timeline.outerBounds().height + timeline.padding() * 2;\n\n  }\n\n}\n","import {elem} from \"d3plus-common\";\n\n/**\n    @function _drawTitle\n    @desc Draws a title if this._title is defined.\n    @param {Array} [*data*] The currently filtered dataset.\n    @private\n*/\nexport default function(data = []) {\n\n  const text = this._title ? this._title(data) : false;\n  const padding = this._titlePadding() ? this._padding : {top: 0, right: 0, bottom: 0, left: 0};\n\n  const transform = {transform: `translate(${this._margin.left + padding.left}, ${this._margin.top})`};\n\n  const group = elem(\"g.d3plus-viz-title\", {\n    enter: transform,\n    parent: this._select,\n    duration: this._duration,\n    update: transform\n  }).node();\n\n  this._titleClass\n    .data(text ? [{text}] : [])\n    .locale(this._locale)\n    .select(group)\n    .width(this._width - (this._margin.left + this._margin.right + padding.left + padding.right))\n    .config(this._titleConfig)\n    .render();\n\n  this._margin.top += text ? group.getBBox().height + this._titleConfig.padding * 2 : 0;\n\n}\n","import {sum} from \"d3-array\";\n\nimport {elem} from \"d3plus-common\";\n\n/**\n    @function _drawTotal\n    @desc Draws a total title if this._total is defined.\n    @param {Array} [*data*] The currently filtered dataset.\n    @private\n*/\nexport default function(data = []) {\n\n  const total = typeof this._total === \"function\" ? sum(data.map(this._total))\n    : this._total === true && this._size ? sum(data.map(this._size)) : false;\n\n  const padding = this._totalPadding() ? this._padding : {top: 0, right: 0, bottom: 0, left: 0};\n\n  const transform = {transform: `translate(${this._margin.left + padding.left}, ${this._margin.top})`};\n\n  const group = elem(\"g.d3plus-viz-total\", {\n    enter: transform,\n    parent: this._select,\n    duration: this._duration,\n    update: transform\n  }).node();\n\n  this._totalClass\n    .data(total ? [{text: this._totalFormat(total)}] : [])\n    .locale(this._locale)\n    .select(group)\n    .width(this._width - (this._margin.left + this._margin.right + padding.left + padding.right))\n    .config(this._totalConfig)\n    .render();\n\n  this._margin.top += total ? group.getBBox().height + this._totalConfig.padding * 2 : 0;\n\n}\n","import {select} from \"d3-selection\";\n\n/**\n  @desc Given an HTMLElement and a \"width\" or \"height\" string, this function returns the current calculated size for the DOM element.\n  @private\n*/\nfunction _elementSize(element, s) {\n\n  if (!element) return undefined;\n\n  if (element.tagName === undefined || [\"BODY\", \"HTML\"].indexOf(element.tagName) >= 0) {\n\n    let val  = window[`inner${s.charAt(0).toUpperCase() + s.slice(1)}`];\n    const elem = select(element);\n\n    if (s === \"width\") {\n      val -= parseFloat(elem.style(\"margin-left\"), 10);\n      val -= parseFloat(elem.style(\"margin-right\"), 10);\n      val -= parseFloat(elem.style(\"padding-left\"), 10);\n      val -= parseFloat(elem.style(\"padding-right\"), 10);\n    }\n    else {\n      val -= parseFloat(elem.style(\"margin-top\"), 10);\n      val -= parseFloat(elem.style(\"margin-bottom\"), 10);\n      val -= parseFloat(elem.style(\"padding-top\"), 10);\n      val -= parseFloat(elem.style(\"padding-bottom\"), 10);\n    }\n\n    return val;\n\n  }\n  else {\n\n    const val = parseFloat(select(element).style(s), 10);\n    if (typeof val === \"number\" && val > 0) return val;\n    else return _elementSize(element.parentNode, s);\n\n  }\n}\n\n/**\n    @function getSize\n    @desc Finds the available width and height for a specified HTMLElement, traversing it's parents until it finds something with constrained dimensions. Falls back to the inner dimensions of the browser window if none is found.\n    @param {HTMLElement} elem The HTMLElement to find dimensions for.\n    @private\n*/\nexport default function(elem) {\n  return [_elementSize(elem, \"width\"), _elementSize(elem, \"height\")];\n}\n","/**\n  @desc Returns a *Boolean* denoting whether or not a given DOM element is visible in the current window.\n  @param {DOMElement} elem The DOM element to analyze.\n  @param {Number} [buffer = 0] A pixel offset from the edge of the top and bottom of the screen. If a positive value, the element will be deemed visible when it is that many pixels away from entering the viewport. If negative, the element will have to enter the viewport by that many pixels before being deemed visible.\n  @private\n*/\nexport default function(elem, buffer = 0) {\n\n  const pageX = window.pageXOffset !== undefined ? window.pageXOffset\n    : (document.documentElement || document.body.parentNode || document.body).scrollLeft;\n\n  const pageY = window.pageYOffset !== undefined ? window.pageYOffset\n    : (document.documentElement || document.body.parentNode || document.body).scrollTop;\n\n  const bounds = elem.getBoundingClientRect();\n  const height = bounds.height,\n        left = bounds.left + pageX,\n        top = bounds.top + pageY,\n        width = bounds.width;\n\n  return pageY + window.innerHeight > top + buffer && pageY + buffer < top + height &&\n         pageX + window.innerWidth > left + buffer && pageX + buffer < left + width;\n\n}\n","/**\n    @desc On click event for all shapes in a Viz.\n    @param {Object} *d* The data object being interacted with.\n    @param {Number} *i* The index of the data object being interacted with.\n    @private\n*/\nexport default function(d, i) {\n\n  this._select.style(\"cursor\", \"auto\");\n\n  if (this._drawDepth < this._groupBy.length - 1) {\n\n    const filterGroup = this._groupBy[this._drawDepth],\n          filterId = filterGroup(d, i);\n\n    this.hover(false);\n    if (this._tooltip(d, i)) this._tooltipClass.data([]).render();\n\n    const oldFilter = this._filter;\n\n    this._history.push({\n      depth: this._depth,\n      filter: oldFilter\n    });\n\n    this.config({\n      depth: this._drawDepth + 1,\n      filter: (f, x) => (!oldFilter || oldFilter(f, x)) && filterGroup(f, x) === filterId\n    }).render();\n\n  }\n\n}\n","import {merge} from \"d3-array\";\n\n/**\n    @desc On click event for all legend shapes in a Viz.\n    @param {Object} *d* The data object being interacted with.\n    @param {Number} *i* The index of the data object being interacted with.\n    @private\n*/\nexport default function(d, i, x, event) {\n\n  this._select.style(\"cursor\", \"auto\");\n  if (this._tooltip(d, i)) this._tooltipClass.data([]).render();\n\n  let id = this._id(d, i);\n  if (!(id instanceof Array)) id = [id];\n  const hiddenIndex = this._hidden.indexOf(id[0]);\n  const soloIndex = this._solo.indexOf(id[0]);\n  const dataLength = merge(this._legendClass.data().map((d, i) => {\n    let id = this._id(d, i);\n    if (!(id instanceof Array)) id = [id];\n    return id;\n  })).length;\n\n  if (event.shiftKey) {\n\n    if (hiddenIndex < 0 && !this._solo.length) {\n      this._hidden = this._hidden.concat(id);\n      if (this._solo.length === dataLength) this._solo = [];\n      if (this._hidden.length === dataLength) this._hidden = [];\n      this.render();\n    }\n    else if (soloIndex >= 0) {\n      this._solo = [];\n      this._hidden = [];\n      this.render();\n    }\n\n  }\n  else {\n    if (soloIndex < 0 && this._hidden.length < dataLength - 1) {\n      this._solo = id;\n      this._hidden = [];\n    }\n    else {\n      this._solo = [];\n      this._hidden = [];\n    }\n    this.render();\n  }\n\n}\n","const flattenIds = levels => levels.reduce((arr, level) => {\n  if (level instanceof Array) {\n    if (arr.length) {\n      const oldArray = arr.slice();\n      arr = [];\n      level.forEach(id => arr = arr.concat(oldArray.map(a => `${a}_${id}`)));\n    }\n    else {\n      arr = level.slice();\n    }\n  }\n  else if (arr.length) {\n    arr = arr.map(a => `${a}_${level}`);\n  }\n  else {\n    arr.push(level);\n  }\n  return arr;\n}, []);\n\n/**\n    @desc On mouseenter event for all shapes in a Viz.\n    @param {Object} *d* The data object being interacted with.\n    @param {Number} *i* The index of the data object being interacted with.\n    @private\n*/\nexport default function(d, i) {\n\n  if (this._shapeConfig.hoverOpacity !== 1) {\n\n    const filterIds = flattenIds(this._ids(d, i));\n    this.hover((h, x) => {\n      const ids = flattenIds(this._ids(h, x));\n      return filterIds.some(id => ids.includes(id));\n    });\n\n  }\n\n}\n","/**\n    @desc On mouseleave event for all shapes in a Viz.\n    @param {Object} *d* The data object being interacted with.\n    @param {Number} *i* The index of the data object being interacted with.\n    @private\n*/\nexport default function(d, i) {\n\n  setTimeout(() => {\n    if (this._shapeConfig.hoverOpacity !== 1 && this._hover ? this._hover(d, i) : true) {\n      this.hover(false);\n    }\n    const tooltipData = this._tooltipClass.data();\n    if (tooltipData.length && this._tooltip(d, i)) {\n      let tooltipDatum = tooltipData[0];\n      while (tooltipDatum.__d3plus__ && tooltipDatum.data) tooltipDatum = tooltipDatum.data;\n      if (this._id(tooltipDatum) === this._id(d)) this._tooltipClass.data([]).render();\n    }\n  }, 50);\n\n  this._select.style(\"cursor\", \"auto\");\n\n}\n","import {merge} from \"d3-array\";\n\nimport {configPrep} from \"d3plus-common\";\n\nimport {legendLabel} from \"../_drawLegend\";\n\n/**\n    @desc Tooltip logic for a specified data point.\n    @param {Object} *d* The data object being interacted with.\n    @param {Number} *i* The index of the data object being interacted with.\n    @param {Object} [*config*] Optional configuration methods for the Tooltip class.\n    @private\n*/\nexport default function(d, i, x, event) {\n\n  const position = event.touches ? [event.touches[0].clientX, event.touches[0].clientY] : [event.clientX, event.clientY];\n  const dataLength = merge(this._legendClass.data().map((d, i) => {\n    let id = this._id(d, i);\n    if (!(id instanceof Array)) id = [id];\n    return id;\n  })).length;\n\n  if (d && this._tooltip(d, i)) {\n\n    let id = this._id(d, i);\n    if (id instanceof Array) id = id[0];\n    const t = this._translate;\n\n    this._select.style(\"cursor\", \"pointer\");\n    this._tooltipClass.data([x || d])\n      .footer(\n        this._solo.length && !this._solo.includes(id) ? t(\"Click to Highlight\")\n        : this._solo.length === 1 && this._solo.includes(id) || this._hidden.length === dataLength - 1 ? t(\"Click to Reset\")\n        : this._solo.includes(id) ? t(\"Click to Hide\")\n        : this._hidden.includes(id) ? t(\"Click to Highlight\")\n        : `${t(\"Click to Highlight\")}<br />${t(\"Shift+Click to Hide\")}`\n      )\n      .title(this._legendConfig.label ? this._legendClass.label() : legendLabel.bind(this))\n      .position(position)\n      .config(configPrep.bind(this)(this._tooltipConfig))\n      .config(configPrep.bind(this)(this._legendTooltip))\n      .render();\n\n  }\n\n}\n","import {configPrep} from \"d3plus-common\";\n\n/**\n    @desc Tooltip logic for a specified data point.\n    @param {Object} *d* The data object being interacted with.\n    @param {Number} *i* The index of the data object being interacted with.\n    @param {Object} [*config*] Optional configuration methods for the Tooltip class.\n    @private\n*/\nexport default function(d, i, x, event) {\n\n  if (d && this._tooltip(d, i)) {\n    this._select.style(\"cursor\", \"pointer\");\n    const position = event.touches ? [event.touches[0].clientX, event.touches[0].clientY] : [event.clientX, event.clientY];\n    this._tooltipClass.data([x || d])\n      .footer(this._drawDepth < this._groupBy.length - 1 ? this._translate(\"Click to Expand\") : false)\n      .title(this._drawLabel)\n      .position(position)\n      .config(configPrep.bind(this)(this._tooltipConfig))\n      .render();\n  }\n\n}\n","/**\n @desc On touchstart event for the Body element.\n @private\n */\nexport default function(d, i, x, event) {\n  event.preventDefault();\n  event.stopPropagation();\n\n  if (!d) this._tooltipClass.data([]).render();\n}\n","import {select} from \"d3-selection\";\nimport {zoomTransform} from \"d3-zoom\";\n\nimport {attrize, stylize} from \"d3plus-common\";\n\nlet brushing = false;\n\n/**\n    @name zoomControls\n    @desc Sets up initial zoom events and controls.\n    @private\n*/\nexport default function() {\n\n  if (!this._container || !this._zoomGroup) return;\n\n  const height = this._zoomHeight || this._height - this._margin.top - this._margin.bottom,\n        that = this,\n        width = this._zoomWidth || this._width - this._margin.left - this._margin.right;\n\n  this._zoomBehavior\n    .extent([[0, 0], [width, height]])\n    .scaleExtent([1, this._zoomMax])\n    .translateExtent([[0, 0], [width, height]])\n    .on(\"zoom\", event => zoomed.bind(this)(event.transform));\n\n  this._zoomToBounds = zoomToBounds.bind(this);\n\n  let control = select(this._select.node().parentNode).selectAll(\"div.d3plus-zoom-control\").data(this._zoom ? [0] : []);\n  const controlEnter = control.enter().append(\"div\").attr(\"class\", \"d3plus-zoom-control\");\n  control.exit().remove();\n  control = control.merge(controlEnter)\n    .style(\"position\", \"absolute\")\n    .style(\"top\", `${this._margin.top}px`)\n    .style(\"left\", `${this._margin.left}px`);\n\n  controlEnter.append(\"div\").attr(\"class\", \"zoom-control zoom-in\");\n  control.select(\".zoom-in\")\n    .on(\"click\", zoomMath.bind(this, this._zoomFactor))\n    .html(\"&#65291;\");\n\n  controlEnter.append(\"div\").attr(\"class\", \"zoom-control zoom-out\");\n  control.select(\".zoom-out\")\n    .on(\"click\", zoomMath.bind(this, 1 / this._zoomFactor))\n    .html(\"&#65293;\");\n\n  controlEnter.append(\"div\").attr(\"class\", \"zoom-control zoom-reset\");\n  control.select(\".zoom-reset\")\n    .on(\"click\", zoomMath.bind(this, 0))\n    .html(\"&#8634\");\n\n  controlEnter.append(\"div\").attr(\"class\", \"zoom-control zoom-brush\");\n  control.select(\".zoom-brush\")\n    .on(\"click\", function() {\n      select(this)\n        .classed(\"active\", !brushing)\n        .call(stylize, brushing ? that._zoomControlStyle || {} : that._zoomControlStyleActive || {});\n      zoomEvents.bind(that)(!brushing);\n    })\n    .html(\"&#164\");\n\n  control.selectAll(\".zoom-control\")\n    .call(stylize, that._zoomControlStyle)\n    .on(\"mouseenter\", function() {\n      select(this).call(stylize, that._zoomControlStyleHover || {});\n    })\n    .on(\"mouseleave\", function() {\n      select(this).call(stylize, select(this).classed(\"active\") ? that._zoomControlStyleActive || {} : that._zoomControlStyle || {});\n    });\n\n  this._zoomBrush\n    .extent([[0, 0], [width, height]])\n    .filter(event => !event.button && event.detail < 2)\n    .handleSize(this._zoomBrushHandleSize)\n    .on(\"start\", brushStart.bind(this))\n    .on(\"brush\", brushBrush.bind(this))\n    .on(\"end\", brushEnd.bind(this));\n\n  const brushGroup = this._container.selectAll(\"g.brush\").data([0]);\n  this._brushGroup = brushGroup.enter().append(\"g\")\n      .attr(\"class\", \"brush\")\n    .merge(brushGroup)\n    .call(this._zoomBrush);\n\n  zoomEvents.bind(this)();\n  if (this._renderTiles) this._renderTiles(zoomTransform(this._container.node()), 0);\n\n}\n\n/**\n    @name zoomEvents\n    @desc Handles adding/removing zoom event listeners.\n    @private\n*/\nfunction zoomEvents(brush = false) {\n\n  brushing = brush;\n\n  if (brushing) this._brushGroup.style(\"display\", \"inline\");\n  else this._brushGroup.style(\"display\", \"none\");\n\n  if (!brushing && this._zoom) {\n    this._container.call(this._zoomBehavior);\n    if (!this._zoomScroll) {\n      this._container\n        .on(\"wheel.zoom\", null);\n    }\n    if (!this._zoomPan) {\n      this._container\n        .on(\"mousedown.zoom mousemove.zoom\", null)\n        .on(\"touchstart.zoom touchmove.zoom touchend.zoom touchcancel.zoom\", null);\n    }\n  }\n  else {\n    this._container.on(\".zoom\", null);\n  }\n\n}\n\n/**\n    @name zoomed\n    @desc Handles events dispatched from this._zoomBehavior\n    @param {Object} [*transform* = event.transform]\n    @param {Number} [*duration* = 0]\n    @private\n*/\nfunction zoomed(transform = false, duration = 0) {\n\n  if (this._zoomGroup) {\n    if (!duration) this._zoomGroup.attr(\"transform\", transform);\n    else this._zoomGroup.transition().duration(duration).attr(\"transform\", transform);\n  }\n\n  if (this._renderTiles) this._renderTiles(zoomTransform(this._container.node()), duration);\n\n}\n\n/**\n    @name zoomMath\n    @desc Zooms in or out based on the provided multiplier.\n    @param {Number} [*factor* = 0]\n    @private\n*/\nfunction zoomMath(factor = 0) {\n\n  if (!this._container) return;\n\n  const center = this._zoomBehavior.extent().bind(document)()[1].map(d => d / 2),\n        scaleExtent = this._zoomBehavior.scaleExtent(),\n        t = zoomTransform(this._container.node());\n\n  if (!factor) {\n    t.k = scaleExtent[0];\n    t.x = 0;\n    t.y = 0;\n  }\n  else {\n    const translate0 = [(center[0] - t.x) / t.k, (center[1] - t.y) / t.k];\n    t.k = Math.min(scaleExtent[1], t.k * factor);\n    if (t.k <= scaleExtent[0]) {\n      t.k = scaleExtent[0];\n      t.x = 0;\n      t.y = 0;\n    }\n    else {\n      t.x += center[0] - (translate0[0] * t.k + t.x);\n      t.y += center[1] - (translate0[1] * t.k + t.y);\n    }\n\n  }\n\n  zoomed.bind(this)(t, this._duration);\n\n}\n\n/**\n    @name zoomToBounds\n    @desc Zooms to given bounds.\n    @param {Array} *bounds*\n    @param {Number} [*duration* = 0]\n    @private\n*/\nfunction zoomToBounds(bounds, duration = this._duration) {\n\n  const scaleExtent = this._zoomBehavior.scaleExtent(),\n        t = zoomTransform(this._container.node());\n\n  if (bounds) {\n\n    const [width, height] = this._zoomBehavior.translateExtent()[1],\n          dx = bounds[1][0] - bounds[0][0],\n          dy = bounds[1][1] - bounds[0][1];\n\n    let k = Math.min(scaleExtent[1], 1 / Math.max(dx / width, dy / height));\n\n    let xMod, yMod;\n    if (dx / dy < width / height) {\n      k *= (height - this._zoomPadding * 2) / height;\n      xMod = (width - dx * k) / 2 / k;\n      yMod = this._zoomPadding / k;\n    }\n    else {\n      k *= (width - this._zoomPadding * 2) / width;\n      yMod = (height - dy * k) / 2 / k;\n      xMod = this._zoomPadding / k;\n    }\n\n    t.x = (t.x - bounds[0][0] + xMod) * (t.k * k / t.k);\n    t.y = (t.y - bounds[0][1] + yMod) * (t.k * k / t.k);\n    t.k *= k;\n\n    if (t.x > 0) t.x = 0;\n    else if (t.x < width * -t.k + width) t.x = width * -t.k + width;\n    if (t.y > 0) t.y = 0;\n    else if (t.y < height * -t.k + height) t.y = height * -t.k + height;\n\n  }\n  else {\n\n    t.k = scaleExtent[0];\n    t.x = 0;\n    t.y = 0;\n\n  }\n\n  zoomed.bind(this)(t, duration);\n\n}\n\n/**\n    @desc Triggered on brush \"brush\".\n    @private\n*/\nfunction brushBrush() {\n  brushStyle.bind(this)();\n}\n\n/**\n    @desc Triggered on brush \"end\".\n    @private\n*/\nfunction brushEnd(event) {\n\n  if (!event.selection) return; // Only transition after input.\n\n  this._brushGroup.call(this._zoomBrush.move, null);\n  zoomToBounds.bind(this)(event.selection);\n\n}\n\n/**\n    @desc Triggered on brush \"start\".\n    @private\n*/\nfunction brushStart() {\n  brushStyle.bind(this)();\n}\n\n/**\n    @desc Overrides the default brush styles.\n    @private\n*/\nfunction brushStyle() {\n\n  this._brushGroup.selectAll(\".selection\")\n    .call(attrize, this._zoomBrushSelectionStyle || {});\n\n  this._brushGroup.selectAll(\".handle\")\n    .call(attrize, this._zoomBrushHandleStyle || {});\n\n}\n","import {select} from \"d3-selection\";\nimport {stylize} from \"d3plus-common\";\n\n/**\n    @name _drawAttribution\n    @desc Draws absolute positioned attribution text.\n    @private\n*/\nexport default function() {\n\n  let attr = select(this._select.node().parentNode)\n    .selectAll(\"div.d3plus-attribution\")\n    .data(this._attribution ? [0] : []);\n\n  const attrEnter = attr.enter().append(\"div\")\n    .attr(\"class\", \"d3plus-attribution\");\n\n  attr.exit().remove();\n\n  attr = attr.merge(attrEnter)\n    .style(\"position\", \"absolute\")\n    .html(this._attribution)\n    .style(\"right\", `${this._margin.right}px`)\n    .style(\"bottom\", `${this._margin.bottom}px`)\n    .call(stylize, this._attributionStyle);\n\n}\n","/**\n    @external BaseClass\n    @see https://github.com/d3plus/d3plus-common#BaseClass\n*/\n\nimport {group, max, merge as arrayMerge, min, range, rollup} from \"d3-array\";\nimport {brush} from \"d3-brush\";\nimport {color} from \"d3-color\";\nimport {queue} from \"d3-queue\";\nimport {select} from \"d3-selection\";\nimport {zoom} from \"d3-zoom\";\n\nimport lrucache from \"lrucache\";\n\nimport {date} from \"d3plus-axis\";\nimport {colorAssign, colorContrast} from \"d3plus-color\";\nimport {accessor, assign, BaseClass, constant, merge, unique} from \"d3plus-common\";\nimport {formatAbbreviate} from \"d3plus-format\";\nimport {ColorScale, Legend} from \"d3plus-legend\";\nimport {TextBox} from \"d3plus-text\";\nimport {Timeline} from \"d3plus-timeline\";\nimport {Tooltip} from \"d3plus-tooltip\";\n\n// import {Rect} from \"d3plus-shape\";\n// import {configPrep} from \"d3plus-common\";\n\nimport Message from \"./Message\";\n\nimport drawBack from \"./_drawBack\";\nimport drawColorScale from \"./_drawColorScale\";\nimport {default as drawLegend, legendLabel} from \"./_drawLegend\";\nimport drawTimeline from \"./_drawTimeline\";\nimport drawTitle from \"./_drawTitle\";\nimport drawTotal from \"./_drawTotal\";\nimport getSize from \"./_getSize\";\nimport inViewport from \"./_inViewport\";\nimport addToQueue from \"./data/addToQueue\";\n\nimport clickShape from \"./on/click.shape\";\nimport clickLegend from \"./on/click.legend\";\nimport mouseenter from \"./on/mouseenter\";\nimport mouseleave from \"./on/mouseleave\";\nimport mousemoveLegend from \"./on/mousemove.legend\";\nimport mousemoveShape from \"./on/mousemove.shape\";\nimport touchstartBody from \"./on/touchstart.body\";\n\nimport zoomControls from \"./_zoomControls\";\nimport drawAttribution from \"./_drawAttribution\";\n\n/**\n * Default padding logic that will return false if the screen is less than 600 pixels wide.\n */\nfunction defaultPadding() {\n  return typeof window !== \"undefined\" ? window.innerWidth > 600 : true;\n}\n\n/**\n * Turns an array of values into a list string.\n */\nfunction listify(n) {\n  return n.reduce((str, item, i) => {\n    if (!i) str += item;\n    else if (i === n.length - 1 && i === 1) str += ` and ${item}`;\n    else if (i === n.length - 1) str += `, and ${item}`;\n    else str += `, ${item}`;\n    return str;\n  }, \"\");\n}\n\n/**\n    @class Viz\n    @extends external:BaseClass\n    @desc Creates an x/y plot based on an array of data. If *data* is specified, immediately draws the tree map based on the specified array and returns the current class instance. If *data* is not specified on instantiation, it can be passed/updated after instantiation using the [data](#treemap.data) method. See [this example](https://d3plus.org/examples/d3plus-treemap/getting-started/) for help getting started using the treemap generator.\n*/\nexport default class Viz extends BaseClass {\n\n  /**\n      @memberof Viz\n      @desc Invoked when creating a new class instance, and sets any default parameters.\n      @private\n  */\n  constructor() {\n\n    super();\n\n    this._aggs = {};\n    this._ariaHidden = true;\n    this._attribution = false;\n    this._attributionStyle = {\n      background: \"rgba(255, 255, 255, 0.75)\",\n      border: \"1px solid rgba(0, 0, 0, 0.25)\",\n      color: \"rgba(0, 0, 0, 0.75)\",\n      display: \"block\",\n      font: \"400 11px/11px 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif\",\n      margin: \"5px\",\n      opacity: 0.75,\n      padding: \"4px 6px 3px\"\n    };\n    this._backClass = new TextBox()\n      .on(\"click\", () => {\n        if (this._history.length) this.config(this._history.pop()).render();\n        else this.depth(this._drawDepth - 1).filter(false).render();\n      })\n      .on(\"mousemove\", () => this._backClass.select().style(\"cursor\", \"pointer\"));\n    this._backConfig = {\n      fontSize: 10,\n      padding: 5,\n      resize: false\n    };\n    this._cache = true;\n\n    this._color = (d, i) => this._groupBy[0](d, i);\n    this._colorScaleClass = new ColorScale();\n    this._colorScaleConfig = {\n      scale: \"jenks\"\n    };\n    this._colorScalePadding = defaultPadding;\n    this._colorScalePosition = () => this._width > this._height ? \"right\" : \"bottom\";\n    this._colorScaleMaxSize = 600;\n\n    this._data = [];\n    this._dataCutoff = 100;\n    this._detectResize = true;\n    this._detectResizeDelay = 400;\n    this._detectVisible = true;\n    this._detectVisibleInterval = 1000;\n    this._downloadButton = false;\n    this._downloadConfig = {type: \"png\"};\n    this._downloadPosition = \"top\";\n    this._duration = 600;\n    this._hidden = [];\n    this._hiddenColor = constant(\"#aaa\");\n    this._hiddenOpacity = constant(0.5);\n    this._history = [];\n    this._groupBy = [accessor(\"id\")];\n\n    this._legend = (config, arr) => {\n      const maxGrouped = max(arr, (d, i) => {\n        const id = this._groupBy[this._legendDepth].bind(this)(d, i);\n        return id instanceof Array ? id.length : 1;\n      });\n      return arr.length > 1 && maxGrouped <= 2;\n    };\n    this._legendClass = new Legend();\n    this._legendConfig = {\n      label: legendLabel.bind(this),\n      shapeConfig: {\n        ariaLabel: legendLabel.bind(this),\n        labelConfig: {\n          fontColor: undefined,\n          fontResize: false,\n          padding: 0\n        }\n      }\n    };\n    this._legendPadding = defaultPadding;\n    this._legendPosition = () => this._width > this._height ? \"right\" : \"bottom\";\n    this._legendSort = (a, b) => this._drawLabel(a).localeCompare(this._drawLabel(b));\n    this._legendTooltip = {};\n\n    this._loadingHTML = () => `\n    <div style=\"left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;\">\n      <strong>${this._translate(\"Loading Visualization\")}</strong>\n      <sub style=\"bottom: 0; display: block; line-height: 1; margin-top: 5px;\"><a href=\"https://d3plus.org\" target=\"_blank\">${this._translate(\"Powered by D3plus\")}</a></sub>\n    </div>`;\n\n    this._loadingMessage = true;\n    this._lrucache = lrucache(10);\n    this._messageClass = new Message();\n    this._messageMask = \"rgba(0, 0, 0, 0.05)\";\n    this._messageStyle = {\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"position\": \"absolute\",\n      \"right\": \"0\",\n      \"text-align\": \"center\",\n      \"top\": \"0\"\n    };\n\n    this._noDataHTML = () => `\n    <div style=\"left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;\">\n      <strong>${this._translate(\"No Data Available\")}</strong>\n    </div>`;\n\n    this._noDataMessage = true;\n    this._on = {\n      \"click.shape\": clickShape.bind(this),\n      \"click.legend\": clickLegend.bind(this),\n      \"mouseenter\": mouseenter.bind(this),\n      \"mouseleave\": mouseleave.bind(this),\n      \"mousemove.shape\": mousemoveShape.bind(this),\n      \"mousemove.legend\": mousemoveLegend.bind(this)\n    };\n    this._queue = [];\n    this._scrollContainer = typeof window === undefined ? \"\" : window;\n    this._shape = constant(\"Rect\");\n    this._shapes = [];\n    this._shapeConfig = {\n      ariaLabel: (d, i) => this._drawLabel(d, i),\n      fill: (d, i) => {\n        while (d.__d3plus__ && d.data) {\n          d = d.data;\n          i = d.i;\n        }\n        if (this._colorScale) {\n          const c = this._colorScale(d, i);\n          if (c !== undefined && c !== null) {\n            const scale = this._colorScaleClass._colorScale;\n            const colors = this._colorScaleClass.color();\n            if (!scale) return colors instanceof Array ? colors[colors.length - 1] : colors;\n            else if (!scale.domain().length) return scale.range()[scale.range().length - 1];\n            return scale(c);\n          }\n        }\n        const c = this._color(d, i);\n        if (color(c)) return c;\n        return colorAssign(c);\n      },\n      labelConfig: {\n        fontColor: (d, i) => {\n          const c = typeof this._shapeConfig.fill === \"function\" ? this._shapeConfig.fill(d, i) : this._shapeConfig.fill;\n          return colorContrast(c);\n        }\n      },\n      opacity: constant(1),\n      stroke: (d, i) => {\n        const c = typeof this._shapeConfig.fill === \"function\" ? this._shapeConfig.fill(d, i) : this._shapeConfig.fill;\n        return color(c).darker();\n      },\n      role: \"presentation\",\n      strokeWidth: constant(0)\n    };\n    this._solo = [];\n    this._svgDesc = \"\";\n    this._svgTitle = \"\";\n\n    this._timeline = true;\n    this._timelineClass = new Timeline().align(\"end\");\n    this._timelineConfig = {\n      brushing: false,\n      padding: 5\n    };\n    this._timelinePadding = defaultPadding;\n\n    this._threshold = constant(0.0001);\n    this._thresholdKey = undefined;\n    this._thresholdName = () => this._translate(\"Values\");\n\n    this._titleClass = new TextBox();\n    this._titleConfig = {\n      ariaHidden: true,\n      fontSize: 12,\n      padding: 5,\n      resize: false,\n      textAnchor: \"middle\"\n    };\n    this._titlePadding = defaultPadding;\n\n    this._tooltip = constant(true);\n    this._tooltipClass = new Tooltip();\n    this._tooltipConfig = {\n      pointerEvents: \"none\",\n      titleStyle: {\n        \"max-width\": \"200px\"\n      }\n    };\n\n    this._totalClass = new TextBox();\n    this._totalConfig = {\n      fontSize: 10,\n      padding: 5,\n      resize: false,\n      textAnchor: \"middle\"\n    };\n    this._totalFormat = d => `${this._translate(\"Total\")}: ${formatAbbreviate(d, this._locale)}`;\n    this._totalPadding = defaultPadding;\n\n    this._zoom = false;\n    this._zoomBehavior = zoom();\n    this._zoomBrush = brush();\n    this._zoomBrushHandleSize = 1;\n    this._zoomBrushHandleStyle = {\n      fill: \"#444\"\n    };\n    this._zoomBrushSelectionStyle = {\n      \"fill\": \"#777\",\n      \"stroke-width\": 0\n    };\n    this._zoomControlStyle = {\n      \"background\": \"rgba(255, 255, 255, 0.75)\",\n      \"border\": \"1px solid rgba(0, 0, 0, 0.75)\",\n      \"color\": \"rgba(0, 0, 0, 0.75)\",\n      \"display\": \"block\",\n      \"font\": \"900 15px/21px 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif\",\n      \"height\": \"20px\",\n      \"margin\": \"5px\",\n      \"opacity\": 0.75,\n      \"padding\": 0,\n      \"text-align\": \"center\",\n      \"width\": \"20px\"\n    };\n    this._zoomControlStyleActive = {\n      background: \"rgba(0, 0, 0, 0.75)\",\n      color: \"rgba(255, 255, 255, 0.75)\",\n      opacity: 1\n    };\n    this._zoomControlStyleHover = {\n      cursor: \"pointer\",\n      opacity: 1\n    };\n    this._zoomFactor = 2;\n    this._zoomMax = 16;\n    this._zoomPadding = 20;\n    this._zoomPan = true;\n    this._zoomScroll = true;\n\n  }\n\n  /**\n   @memberof Viz\n   @desc Called by draw before anything is drawn. Formats the data and performs preparations for draw.\n   @private\n   */\n  _preDraw() {\n    const that = this;\n\n    // based on the groupBy, determine the draw depth and current depth id\n    this._drawDepth = this._depth !== void 0\n      ? min([this._depth >= 0 ? this._depth : 0, this._groupBy.length - 1])\n      : this._groupBy.length - 1;\n    this._id = this._groupBy[this._drawDepth];\n    this._ids = (d, i) => this._groupBy\n      .map(g => !d || d.__d3plus__ && !d.data ? undefined : g(d.__d3plus__ ? d.data : d, d.__d3plus__ ? d.i : i))\n      .filter(g => g !== undefined && g !== null);\n\n    this._drawLabel = (d, i, depth = this._drawDepth) => {\n      if (!d) return \"\";\n      while (d.__d3plus__ && d.data) {\n        d = d.data;\n        i = d.i;\n      }\n      if (d._isAggregation) {\n        return `${this._thresholdName(d, i)} < ${formatAbbreviate(d._threshold * 100, this._locale)}%`;\n      }\n      if (this._label) return `${this._label(d, i)}`;\n      const l = that._ids(d, i).slice(0, depth + 1);\n      const n = l.reverse().find(ll => !(ll instanceof Array)) || l[l.length - 1];\n      return n instanceof Array ? listify(n) : `${n}`;\n    };\n\n    // set the default timeFilter if it has not been specified\n    if (this._time && !this._timeFilter && this._data.length) {\n\n      const dates = this._data.map(this._time).map(date);\n      const d = this._data[0], i = 0;\n\n      if (this._discrete && `_${this._discrete}` in this && this[`_${this._discrete}`](d, i) === this._time(d, i)) {\n        this._timeFilter = () => true;\n      }\n      else {\n        const latestTime = +max(dates);\n        this._timeFilter = (d, i) => +date(this._time(d, i)) === latestTime;\n      }\n\n    }\n\n    this._filteredData = [];\n    this._legendData = [];\n    let flatData = [];\n    if (this._data.length) {\n\n      flatData = this._timeFilter ? this._data.filter(this._timeFilter) : this._data;\n      if (this._filter) flatData = flatData.filter(this._filter);\n      const nestKeys = [];\n      for (let i = 0; i <= this._drawDepth; i++) nestKeys.push(this._groupBy[i]);\n      if (this._discrete && `_${this._discrete}` in this) nestKeys.push(this[`_${this._discrete}`]);\n      if (this._discrete && `_${this._discrete}2` in this) nestKeys.push(this[`_${this._discrete}2`]);\n\n      const tree = rollup(flatData, leaves => {\n\n        const index = this._data.indexOf(leaves[0]);\n        const shape = this._shape(leaves[0], index);\n        const id = this._id(leaves[0], index);\n\n        const d = merge(leaves, this._aggs);\n\n        if (!this._hidden.includes(id) && (!this._solo.length || this._solo.includes(id))) {\n          if (!this._discrete && shape === \"Line\") this._filteredData = this._filteredData.concat(leaves);\n          else this._filteredData.push(d);\n        }\n        this._legendData.push(d);\n\n      }, ...nestKeys);\n\n      this._filteredData = this._thresholdFunction(this._filteredData, tree);\n\n    }\n\n    // overrides the hoverOpacity of shapes if data is larger than cutoff\n    const uniqueIds = group(this._filteredData, this._id).size;\n    if (uniqueIds > this._dataCutoff) {\n      if (this._userHover === undefined) this._userHover = this._shapeConfig.hoverOpacity || 0.5;\n      if (this._userDuration === undefined) this._userDuration = this._shapeConfig.duration || 600;\n      this._shapeConfig.hoverOpacity = 1;\n      this._shapeConfig.duration = 0;\n    }\n    else if (this._userHover !== undefined) {\n      this._shapeConfig.hoverOpacity = this._userHover;\n      this._shapeConfig.duration = this._userDuration;\n    }\n\n    if (this._noDataMessage && !this._filteredData.length) {\n      this._messageClass.render({\n        container: this._select.node().parentNode,\n        html: this._noDataHTML(this),\n        mask: false,\n        style: this._messageStyle\n      });\n      this._select.transition().duration(this._duration).attr(\"opacity\", 0);\n    }\n\n  }\n\n  /**\n      @memberof Viz\n      @desc Called by render once all checks are passed.\n      @private\n  */\n  _draw() {\n\n    let legendPosition = this._legendPosition.bind(this)(this.config());\n    if (![false, \"top\", \"bottom\", \"left\", \"right\"].includes(legendPosition)) legendPosition = \"bottom\";\n    let colorScalePosition = this._colorScalePosition.bind(this)(this.config());\n    if (![false, \"top\", \"bottom\", \"left\", \"right\"].includes(colorScalePosition)) colorScalePosition = \"bottom\";\n    if (legendPosition === \"left\" || legendPosition === \"right\") drawLegend.bind(this)(this._legendData);\n    if (colorScalePosition === \"left\" || colorScalePosition === \"right\" || colorScalePosition === false) drawColorScale.bind(this)(this._filteredData);\n\n    drawBack.bind(this)();\n    drawTitle.bind(this)(this._filteredData);\n    drawTotal.bind(this)(this._filteredData);\n    drawTimeline.bind(this)(this._filteredData);\n\n    if (legendPosition === \"top\" || legendPosition === \"bottom\") drawLegend.bind(this)(this._legendData);\n    if (colorScalePosition === \"top\" || colorScalePosition === \"bottom\") drawColorScale.bind(this)(this._filteredData);\n\n    this._shapes = [];\n\n    // Draws a container and zoomGroup to test functionality.\n    // this._testGroup = this._select.selectAll(\"g.d3plus-viz-testGroup\").data([0]);\n    // const enterTest = this._testGroup.enter().append(\"g\").attr(\"class\", \"d3plus-viz-testGroup\")\n    //   .merge(this._testGroup);\n    // this._testGroup = enterTest.merge(this._testGroup);\n    // const bgHeight = this._height - this._margin.top - this._margin.bottom;\n    // const bgWidth = this._width - this._margin.left - this._margin.right;\n    // new Rect()\n    //   .data([{id: \"background\"}])\n    //   .select(this._testGroup.node())\n    //   .x(bgWidth / 2 + this._margin.left)\n    //   .y(bgHeight / 2 + this._margin.top)\n    //   .width(bgWidth)\n    //   .height(bgHeight)\n    //   .fill(\"#ccc\")\n    //   .render();\n\n    // this._zoomGroup = this._select.selectAll(\"g.d3plus-viz-zoomGroup\").data([0]);\n    // const enter = this._zoomGroup.enter().append(\"g\").attr(\"class\", \"d3plus-viz-zoomGroup\")\n    //   .merge(this._zoomGroup);\n\n    // this._zoomGroup = enter.merge(this._zoomGroup);\n    // const testConfig = {\n    //   on: {\n    //     click: this._on[\"click.shape\"],\n    //     mouseenter: this._on.mouseenter,\n    //     mouseleave: this._on.mouseleave,\n    //     mousemove: this._on[\"mousemove.shape\"]\n    //   }\n    // };\n\n    // const testWidth = 10;\n    // this._shapes.push(new Rect()\n    //   .config(this._shapeConfig)\n    //   .config(configPrep.bind(this)(testConfig))\n    //   .data(this._filteredData)\n    //   .label(\"Test Label\")\n    //   .select(this._zoomGroup.node())\n    //   .id(this._id)\n    //   .x(() => Math.random() * bgWidth)\n    //   .y(() => Math.random() * bgHeight)\n    //   .width(testWidth)\n    //   .height(testWidth)\n    //   .render());\n\n  }\n\n  /**\n   * Applies the threshold algorithm according to the type of chart used.\n   * @param {Array} data The data to process.\n   */\n  _thresholdFunction(data) {\n    return data;\n  }\n\n  /**\n      @memberof Viz\n      @desc Draws the visualization given the specified configuration.\n      @param {Function} [*callback*] An optional callback function that, if passed, will be called after animation is complete.\n      @chainable\n  */\n  render(callback) {\n\n    // Resets margins and padding\n    this._margin = {bottom: 0, left: 0, right: 0, top: 0};\n    this._padding = {bottom: 0, left: 0, right: 0, top: 0};\n\n    // Appends a fullscreen SVG to the BODY if a container has not been provided through .select().\n    if (this._select === void 0 || this._select.node().tagName.toLowerCase() !== \"svg\") {\n      const parent = this._select === void 0 ? select(\"body\").append(\"div\") : this._select;\n      const svg = parent.append(\"svg\");\n      this.select(svg.node());\n    }\n\n    /** detects width and height and sets SVG properties */\n    function setSVGSize() {\n\n      const display = this._select.style(\"display\");\n      this._select.style(\"display\", \"none\");\n\n      let [w, h] = getSize(this._select.node().parentNode);\n      w -= parseFloat(this._select.style(\"border-left-width\"), 10);\n      w -= parseFloat(this._select.style(\"border-right-width\"), 10);\n      h -= parseFloat(this._select.style(\"border-top-width\"), 10);\n      h -= parseFloat(this._select.style(\"border-bottom-width\"), 10);\n      this._select.style(\"display\", display);\n\n      if (this._autoWidth) {\n        this.width(w);\n        this._select.style(\"width\", `${this._width}px`).attr(\"width\", `${this._width}px`);\n      }\n      if (this._autoHeight) {\n        this.height(h);\n        this._select.style(\"height\", `${this._height}px`).attr(\"height\", `${this._height}px`);\n      }\n\n    }\n\n    // Calculates the width and/or height of the Viz based on the this._select, if either has not been defined.\n    if ((!this._width || !this._height) && (!this._detectVisible || inViewport(this._select.node()))) {\n      this._autoWidth = this._width === undefined;\n      this._autoHeight = this._height === undefined;\n      setSVGSize.bind(this)();\n    }\n\n    this._select\n        .attr(\"class\", \"d3plus-viz\")\n        .attr(\"aria-hidden\", this._ariaHidden)\n        .attr(\"aria-labelledby\", `${this._uuid}-title ${this._uuid}-desc`)\n        .attr(\"role\", \"img\")\n        .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\n        .attr(\"xmlns:xlink\", \"http://www.w3.org/1999/xlink\")\n      .transition().duration(this._duration)\n        .style(\"width\", this._width !== undefined ? `${this._width}px` : undefined)\n        .style(\"height\", this._height !== undefined ? `${this._height}px` : undefined)\n        .attr(\"width\", this._width !== undefined ? `${this._width}px` : undefined)\n        .attr(\"height\", this._height !== undefined ? `${this._height}px` : undefined);\n\n    // sets \"position: relative\" on the SVG parent if currently undefined\n    const parent = select(this._select.node().parentNode);\n    const position = parent.style(\"position\");\n    if (position === \"static\") parent.style(\"position\", \"relative\");\n\n    // sets initial opacity to 1, if it has not already been set\n    if (this._select.attr(\"opacity\") === null) this._select.attr(\"opacity\", 1);\n\n    // Updates the <title> tag if already exists else creates a new <title> tag on this.select.\n    const svgTitle = this._select.selectAll(\"title\").data([0]);\n    const svgTitleEnter = svgTitle.enter().append(\"title\").attr(\"id\", `${this._uuid}-title`);\n    svgTitle.merge(svgTitleEnter).text(this._svgTitle);\n\n    // Updates the <desc> tag if already exists else creates a new <desc> tag on this.select.\n    const svgDesc = this._select.selectAll(\"desc\").data([0]);\n    const svgDescEnter = svgDesc.enter().append(\"desc\").attr(\"id\", `${this._uuid}-desc`);\n    svgDesc.merge(svgDescEnter).text(this._svgDesc);\n\n    this._visiblePoll = clearInterval(this._visiblePoll);\n    this._resizePoll = clearTimeout(this._resizePoll);\n    this._scrollPoll = clearTimeout(this._scrollPoll);\n    select(this._scrollContainer).on(`scroll.${this._uuid}`, null);\n    select(this._scrollContainer).on(`resize.${this._uuid}`, null);\n    if (this._detectVisible && this._select.style(\"visibility\") === \"hidden\") {\n\n      this._visiblePoll = setInterval(() => {\n        if (this._select.style(\"visibility\") !== \"hidden\") {\n          this._visiblePoll = clearInterval(this._visiblePoll);\n          this.render(callback);\n        }\n      }, this._detectVisibleInterval);\n\n    }\n    else if (this._detectVisible && this._select.style(\"display\") === \"none\") {\n\n      this._visiblePoll = setInterval(() => {\n        if (this._select.style(\"display\") !== \"none\") {\n          this._visiblePoll = clearInterval(this._visiblePoll);\n          this.render(callback);\n        }\n      }, this._detectVisibleInterval);\n\n    }\n    else if (this._detectVisible && !inViewport(this._select.node())) {\n\n      select(this._scrollContainer).on(`scroll.${this._uuid}`, () => {\n        if (!this._scrollPoll) {\n          this._scrollPoll = setTimeout(() => {\n            if (inViewport(this._select.node())) {\n              select(this._scrollContainer).on(`scroll.${this._uuid}`, null);\n              this.render(callback);\n            }\n            this._scrollPoll = clearTimeout(this._scrollPoll);\n          }, this._detectVisibleInterval);\n        }\n      });\n\n    }\n    else {\n      const q = queue();\n\n      this._queue.forEach(p => {\n        const cache = this._cache\n          ? this._lrucache.get(`${p[3]}_${p[1]}`)\n          : undefined;\n        if (!cache) q.defer(...p);\n        else this[`_${p[3]}`] = p[2] ? p[2](cache) : cache;\n      });\n      this._queue = [];\n\n      if (this._loadingMessage && q._tasks.length) {\n        this._messageClass.render({\n          container: this._select.node().parentNode,\n          html: this._loadingHTML(this),\n          mask: this._filteredData ? this._messageMask : false,\n          style: this._messageStyle\n        });\n      }\n\n      q.awaitAll(() => {\n\n        const columns = this._data instanceof Array && this._data.length > 0 ? Object.keys(this._data[0]) : [];\n        const svgTable = this._select.selectAll(\"g.data-table\")\n          .data(!this._ariaHidden && this._data instanceof Array && this._data.length ? [0] : []);\n        const svgTableEnter = svgTable.enter().append(\"g\")\n          .attr(\"class\", \"data-table\")\n          .attr(\"role\", \"table\");\n        svgTable.exit().remove();\n        const rows = svgTable.merge(svgTableEnter)\n          .selectAll(\"text\")\n          .data(this._data instanceof Array ? range(0, this._data.length + 1) : []);\n        rows.exit().remove();\n        const cells = rows.merge(rows.enter().append(\"text\").attr(\"role\", \"row\"))\n          .selectAll(\"tspan\")\n          .data((d, i) => columns.map(c => ({\n            role: i ? \"cell\" : \"columnheader\",\n            text: i ? this._data[i - 1][c] : c\n          })));\n        cells.exit().remove();\n        cells.merge(cells.enter().append(\"tspan\"))\n          .attr(\"role\", d => d.role)\n          .attr(\"dy\", \"-1000px\")\n          .html(d => d.text);\n\n        this._preDraw();\n        this._draw(callback);\n        zoomControls.bind(this)();\n        drawAttribution.bind(this)();\n\n        if (this._messageClass._isVisible && (!this._noDataMessage || this._filteredData.length)) {\n          this._messageClass.hide();\n          if (this._select.attr(\"opacity\") === \"0\") this._select.transition().duration(this._duration).attr(\"opacity\", 1);\n        }\n\n        if (this._detectResize && (this._autoWidth || this._autoHeight)) {\n          select(this._scrollContainer).on(`resize.${this._uuid}`, () => {\n            this._resizePoll = clearTimeout(this._resizePoll);\n            this._resizePoll = setTimeout(() => {\n              this._resizePoll = clearTimeout(this._resizePoll);\n              setSVGSize.bind(this)();\n              this.render(callback);\n            }, this._detectResizeDelay);\n          });\n        }\n\n        if (callback) setTimeout(callback, this._duration + 100);\n      });\n\n    }\n\n    // Attaches touchstart event listener to the BODY to hide the tooltip when the user touches any element without data\n    select(\"body\").on(`touchstart.${this._uuid}`, touchstartBody.bind(this));\n\n    return this;\n\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the active method to the specified function and returns the current class instance.\n      @param {Function} [*value*]\n      @chainable\n  */\n  active(_) {\n\n    this._active = _;\n\n    if (this._shapeConfig.activeOpacity !== 1) {\n      this._shapes.forEach(s => s.active(_));\n      if (this._legend) this._legendClass.active(_);\n    }\n\n    return this;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the aggregation method for each key in the object and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  aggs(_) {\n    return arguments.length ? (this._aggs = assign(this._aggs, _), this) : this._aggs;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets the \"aria-hidden\" attribute of the containing SVG element. The default value is \"false\", but it you need to hide the SVG from screen readers set this property to \"true\".\n      @param {Boolean} [*value* = true]\n      @chainable\n  */\n  ariaHidden(_) {\n    return arguments.length ? (this._ariaHidden = _, this) : this._ariaHidden;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets text to be shown positioned absolute on top of the visualization in the bottom-right corner. This is most often used in Geomaps to display the copyright of map tiles. The text is rendered as HTML, so any valid HTML string will render as expected (eg. anchor links work).\n      @param {HTMLString|Boolean} *value* = false\n      @chainable\n  */\n  attribution(_) {\n    return arguments.length ? (this._attribution = _, this) : this._attribution;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for the back button and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  attributionStyle(_) {\n    return arguments.length ? (this._attributionStyle = assign(this._attributionStyle, _), this) : this._attributionStyle;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for the back button and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  backConfig(_) {\n    return arguments.length ? (this._backConfig = assign(this._backConfig, _), this) : this._backConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc Enables a lru cache that stores up to 5 previously loaded files/URLs. Helpful when constantly writing over the data array with a URL in the render function of a react component.\n      @param {Boolean} [*value* = false]\n      @chainable\n  */\n  cache(_) {\n    return arguments.length ? (this._cache = _, this) : this._cache;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines the main color to be used for each data point in a visualization. Can be either an accessor function or a string key to reference in each data point. If a color value is returned, it will be used as is. If a string is returned, a unique color will be assigned based on the string.\n      @param {Function|String|False} [*value*]\n      @chainable\n  */\n  color(_) {\n    return arguments.length ? (this._color = !_ || typeof _ === \"function\" ? _ : accessor(_), this) : this._color;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines the value to be used for a color scale. Can be either an accessor function or a string key to reference in each data point.\n      @param {Function|String|False} [*value*]\n      @chainable\n  */\n  colorScale(_) {\n    return arguments.length ? (this._colorScale = !_ || typeof _ === \"function\" ? _ : accessor(_), this) : this._colorScale;\n  }\n\n  /**\n      @memberof Viz\n      @desc A pass-through to the config method of ColorScale.\n      @param {Object} [*value*]\n      @chainable\n  */\n  colorScaleConfig(_) {\n    return arguments.length ? (this._colorScaleConfig = assign(this._colorScaleConfig, _), this) : this._colorScaleConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc Tells the colorScale whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the colorScale appears centered above the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.\n      @param {Boolean|Function} [*value*]\n      @chainable\n  */\n  colorScalePadding(_) {\n    return arguments.length ? (this._colorScalePadding = typeof _ === \"function\" ? _ : constant(_), this) : this._colorScalePadding;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines which side of the visualization to anchor the color scale. Acceptable values are `\"top\"`, `\"bottom\"`, `\"left\"`, `\"right\"`, and `false`. A `false` value will cause the color scale to not be displayed, but will still color shapes based on the scale.\n      @param {Function|String|Boolean} [*value* = \"bottom\"]\n      @chainable\n  */\n  colorScalePosition(_) {\n    return arguments.length ? (this._colorScalePosition = typeof _ === \"function\" ? _ : constant(_), this) : this._colorScalePosition;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets the maximum pixel size for drawing the color scale: width for horizontal scales and height for vertical scales.\n      @param {Number} [*value* = 600]\n      @chainable\n  */\n  colorScaleMaxSize(_) {\n    return arguments.length ? (this._colorScaleMaxSize = _, this) : this._colorScaleMaxSize;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets the primary data array to be used when drawing the visualization. The value passed should be an *Array* of objects or a *String* representing a filepath or URL to be loaded. The following filetypes are supported: `csv`, `tsv`, `txt`, and `json`.\n\nIf your data URL needs specific headers to be set, an Object with \"url\" and \"headers\" keys may also be passed.\n\nAdditionally, a custom formatting function can be passed as a second argument to this method. This custom function will be passed the data that has been loaded, as long as there are no errors. This function should return the final array of obejcts to be used as the primary data array. For example, some JSON APIs return the headers split from the data values to save bandwidth. These would need be joined using a custom formatter.\n\nIf you would like to specify certain configuration options based on the yet-to-be-loaded data, you can also return a full `config` object from the data formatter (including the new `data` array as a key in the object).\n\nIf *data* is not specified, this method returns the current primary data array, which defaults to an empty array (`[]`);\n      @param {Array|String} *data* = []\n      @param {Function} [*formatter*]\n      @chainable\n  */\n  data(_, f) {\n    if (arguments.length) {\n      addToQueue.bind(this)(_, f, \"data\");\n      this._hidden = [];\n      this._solo = [];\n      return this;\n    }\n    return this._data;\n  }\n\n  /**\n      @memberof Viz\n      @desc If the number of visible data points exceeds this number, the default hover behavior will be disabled (helpful for very large visualizations bogging down the DOM with opacity updates).\n      @param {Number} [*value* = 100]\n      @chainable\n  */\n  dataCutoff(_) {\n    return arguments.length ? (this._dataCutoff = _, this) : this._dataCutoff;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the depth to the specified number and returns the current class instance. The *value* should correspond with an index in the [groupBy](#groupBy) array.\n      @param {Number} [*value*]\n      @chainable\n  */\n  depth(_) {\n    return arguments.length ? (this._depth = _, this) : this._depth;\n  }\n\n  /**\n      @memberof Viz\n      @desc If the width and/or height of a Viz is not user-defined, it is determined by the size of it's parent element. When this method is set to `true`, the Viz will listen for the `window.onresize` event and adjust it's dimensions accordingly.\n      @param {Boolean} *value* = true\n      @chainable\n  */\n  detectResize(_) {\n    return arguments.length ? (this._detectResize = _, this) : this._detectResize;\n  }\n\n  /**\n      @memberof Viz\n      @desc When resizing the browser window, this is the millisecond delay to trigger the resize event.\n      @param {Number} *value* = 400\n      @chainable\n  */\n  detectResizeDelay(_) {\n    return arguments.length ? (this._detectResizeDelay = _, this) : this._detectResizeDelay;\n  }\n\n  /**\n      @memberof Viz\n      @desc Toggles whether or not the Viz should try to detect if it visible in the current viewport. When this method is set to `true`, the Viz will only be rendered when it has entered the viewport either through scrolling or if it's display or visibility is changed.\n      @param {Boolean} *value* = true\n      @chainable\n  */\n  detectVisible(_) {\n    return arguments.length ? (this._detectVisible = _, this) : this._detectVisible;\n  }\n\n  /**\n      @memberof Viz\n      @desc The interval, in milliseconds, for checking if the visualization is visible on the page.\n      @param {Number} *value* = 1000\n      @chainable\n  */\n  detectVisibleInterval(_) {\n    return arguments.length ? (this._detectVisibleInterval = _, this) : this._detectVisibleInterval;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the discrete accessor to the specified method name (usually an axis) and returns the current class instance.\n      @param {String} [*value*]\n      @chainable\n  */\n  discrete(_) {\n    return arguments.length ? (this._discrete = _, this) : this._discrete;\n  }\n\n  /**\n      @memberof Viz\n      @desc Shows a button that allows for downloading the current visualization.\n      @param {Boolean} [*value* = false]\n      @chainable\n  */\n  downloadButton(_) {\n    return arguments.length ? (this._downloadButton = _, this) : this._downloadButton;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets specific options of the saveElement function used when downloading the visualization.\n      @param {Object} [*value* = {type: \"png\"}]\n      @chainable\n  */\n  downloadConfig(_) {\n    return arguments.length ? (this._downloadConfig = assign(this._downloadConfig, _), this) : this._downloadConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines which control group to add the download button into.\n      @param {String} [*value* = \"top\"]\n      @chainable\n  */\n  downloadPosition(_) {\n    return arguments.length ? (this._downloadPosition = _, this) : this._downloadPosition;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *ms* is specified, sets the animation duration to the specified number and returns the current class instance. If *ms* is not specified, returns the current animation duration.\n      @param {Number} [*ms* = 600]\n      @chainable\n  */\n  duration(_) {\n    return arguments.length ? (this._duration = _, this) : this._duration;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the filter to the specified function and returns the current class instance.\n      @param {Function} [*value*]\n      @chainable\n  */\n  filter(_) {\n    return arguments.length ? (this._filter = _, this) : this._filter;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the group accessor(s) to the specified string, function, or array of values and returns the current class instance.\n      @param {String|Function|Array} [*value*]\n      @chainable\n      @example\nfunction value(d) {\n  return d.id;\n}\n  */\n  groupBy(_) {\n    if (!arguments.length) return this._groupBy;\n    this._groupByRaw = _;\n    if (!(_ instanceof Array)) _ = [_];\n    return this._groupBy = _.map(k => {\n      if (typeof k === \"function\") return k;\n      else {\n        if (!this._aggs[k]) {\n          this._aggs[k] = (a, c) => {\n            const v = unique(a.map(c));\n            return v.length === 1 ? v[0] : v;\n          };\n        }\n        return accessor(k);\n      }\n    }), this;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the overall height to the specified number and returns the current class instance.\n      @param {Number} [*value* = window.innerHeight]\n      @chainable\n  */\n  height(_) {\n    return arguments.length ? (this._height = _, this) : this._height;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines the color used for legend shapes when the corresponding grouping is hidden from display (by clicking on the legend).\n      @param {Function|String} [*value* = \"#aaa\"]\n      @chainable\n  */\n  hiddenColor(_) {\n    return arguments.length ? (this._hiddenColor = typeof _ === \"function\" ? _ : constant(_), this) : this._hiddenColor;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines the opacity used for legend labels when the corresponding grouping is hidden from display (by clicking on the legend).\n      @param {Function|Number} [*value* = 0.5]\n      @chainable\n  */\n  hiddenOpacity(_) {\n    return arguments.length ? (this._hiddenOpacity = typeof _ === \"function\" ? _ : constant(_), this) : this._hiddenOpacity;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the hover method to the specified function and returns the current class instance.\n      @param {Function} [*value*]\n      @chainable\n  */\n  hover(_) {\n\n    let hoverFunction = this._hover = _;\n\n    if (this._shapeConfig.hoverOpacity !== 1) {\n\n      if (typeof _ === \"function\") {\n\n        let shapeData = arrayMerge(this._shapes.map(s => s.data()));\n        shapeData = shapeData.concat(this._legendClass.data());\n        const activeData = _ ? shapeData.filter(_) : [];\n\n        let activeIds = [];\n        activeData.map(this._ids).forEach(ids => {\n          for (let x = 1; x <= ids.length; x++) {\n            activeIds.push(JSON.stringify(ids.slice(0, x)));\n          }\n        });\n        activeIds = activeIds.filter((id, i) => activeIds.indexOf(id) === i);\n\n        if (activeIds.length) hoverFunction = (d, i) => activeIds.includes(JSON.stringify(this._ids(d, i)));\n\n      }\n\n      this._shapes.forEach(s => s.hover(hoverFunction));\n      if (this._legend) this._legendClass.hover(hoverFunction);\n\n    }\n\n    return this;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the label accessor to the specified function or string and returns the current class instance.\n      @param {Function|String} [*value*]\n      @chainable\n  */\n  label(_) {\n    return arguments.length ? (this._label = typeof _ === \"function\" ? _ : constant(_), this) : this._label;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, toggles the legend based on the specified boolean and returns the current class instance.\n      @param {Boolean|Function} [*value* = true]\n      @chainable\n  */\n  legend(_) {\n    return arguments.length ? (this._legend = typeof _ === \"function\" ? _ : constant(_), this) : this._legend;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, the object is passed to the legend's config method.\n      @param {Object} [*value*]\n      @chainable\n  */\n  legendConfig(_) {\n    return arguments.length ? (this._legendConfig = assign(this._legendConfig, _), this) : this._legendConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for the legend tooltip and returns the current class instance.\n      @param {Object} [*value* = {}]\n      @chainable\n  */\n  legendTooltip(_) {\n    return arguments.length ? (this._legendTooltip = assign(this._legendTooltip, _), this) : this._legendTooltip;\n  }\n\n  /**\n      @memberof Viz\n      @desc Tells the legend whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the legend appears centered underneath the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.\n      @param {Boolean|Function} [*value*]\n      @chainable\n  */\n  legendPadding(_) {\n    return arguments.length ? (this._legendPadding = typeof _ === \"function\" ? _ : constant(_), this) : this._legendPadding;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines which side of the visualization to anchor the legend. Expected values are `\"top\"`, `\"bottom\"`, `\"left\"`, and `\"right\"`.\n      @param {Function|String} [*value* = \"bottom\"]\n      @chainable\n  */\n  legendPosition(_) {\n    return arguments.length ? (this._legendPosition = typeof _ === \"function\" ? _ : constant(_), this) : this._legendPosition;\n  }\n\n  /**\n      @memberof Viz\n      @desc A JavaScript [sort comparator function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort) used to sort the legend.\n      @param {Function} *value*\n      @chainable\n  */\n  legendSort(_) {\n    return arguments.length ? (this._legendSort = _, this) : this._legendSort;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets the inner HTML of the status message that is displayed when loading AJAX requests and displaying errors. Must be a valid HTML string or a function that, when passed this Viz instance, returns a valid HTML string.\n      @param {Function|String} [*value*]\n      @chainable\n  */\n  loadingHTML(_) {\n    return arguments.length ? (this._loadingHTML = typeof _ === \"function\" ? _ : constant(_), this) : this._loadingHTML;\n  }\n\n  /**\n      @memberof Viz\n      @desc Toggles the visibility of the status message that is displayed when loading AJAX requests and displaying errors.\n      @param {Boolean} [*value* = true]\n      @chainable\n  */\n  loadingMessage(_) {\n    return arguments.length ? (this._loadingMessage = _, this) : this._loadingMessage;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets the color of the mask used underneath the status message that is displayed when loading AJAX requests and displaying errors. Additionally, `false` will turn off the mask completely.\n      @param {Boolean|String} [*value* = \"rgba(0, 0, 0, 0.1)\"]\n      @chainable\n  */\n  messageMask(_) {\n    return arguments.length ? (this._messageMask = _, this) : this._messageMask;\n  }\n\n  /**\n      @memberof Viz\n      @desc Defines the CSS style properties for the status message that is displayed when loading AJAX requests and displaying errors.\n      @param {Object} [*value*]\n      @chainable\n  */\n  messageStyle(_) {\n    return arguments.length ? (this._messageStyle = assign(this._messageStyle, _), this) : this._messageStyle;\n  }\n\n  /**\n      @memberof Viz\n      @desc Sets the inner HTML of the status message that is displayed when no data is supplied to the visualization. Must be a valid HTML string or a function that, when passed this Viz instance, returns a valid HTML string.\n      @param {Function|String} [*value*]\n      @chainable\n  */\n  noDataHTML(_) {\n    return arguments.length ? (this._noDataHTML = typeof _ === \"function\" ? _ : constant(_), this) : this._noDataHTML;\n  }\n\n  /**\n     @memberof Viz\n     @desc Toggles the visibility of the status message that is displayed when no data is supplied to the visualization.\n     @param {Boolean} [*value* = true]\n     @chainable\n  */\n  noDataMessage(_) {\n    return arguments.length ? (this._noDataMessage = _, this) : this._noDataMessage;\n  }\n\n  /**\n      @memberof Viz\n      @desc If using scroll or visibility detection, this method allow a custom override of the element to which the scroll detection function gets attached.\n      @param {String|HTMLElement} *selector*\n      @chainable\n  */\n  scrollContainer(_) {\n    return arguments.length ? (this._scrollContainer = _, this) : this._scrollContainer;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element, which is `undefined` by default.\n      @param {String|HTMLElement} [*selector*]\n      @chainable\n  */\n  select(_) {\n    return arguments.length ? (this._select = select(_), this) : this._select;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the shape accessor to the specified function or number and returns the current class instance.\n      @param {Function|String} [*value*]\n      @chainable\n  */\n  shape(_) {\n    return arguments.length ? (this._shape = typeof _ === \"function\" ? _ : constant(_), this) : this._shape;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for each shape and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  shapeConfig(_) {\n    return arguments.length ? (this._shapeConfig = assign(this._shapeConfig, _), this) : this._shapeConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the description accessor to the specified string and returns the current class instance.\n      @param {String} [*value*]\n      @chainable\n  */\n  svgDesc(_) {\n    return arguments.length ? (this._svgDesc = _, this) : this._svgDesc;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the title accessor to the specified string and returns the current class instance.\n      @param {String} [*value*]\n      @chainable\n  */\n  svgTitle(_) {\n    return arguments.length ? (this._svgTitle = _, this) : this._svgTitle;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the threshold for buckets to the specified function or string, and returns the current class instance.\n      @param {Function|Number} [value]\n      @chainable\n   */\n  threshold(_) {\n    if (arguments.length) {\n      if (typeof _ === \"function\") {\n        this._threshold = _;\n      }\n      else if (isFinite(_) && !isNaN(_)) {\n        this._threshold = constant(_ * 1);\n      }\n      return this;\n    }\n    else return this._threshold;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the accesor for the value used in the threshold algorithm, and returns the current class instance.\n      @param {Function|Number} [value]\n      @chainable\n   */\n  thresholdKey(key) {\n    if (arguments.length) {\n      if (typeof key === \"function\") {\n        this._thresholdKey = key;\n      }\n      else {\n        this._thresholdKey = accessor(key);\n      }\n      return this;\n    }\n    else return this._thresholdKey;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the label for the bucket item, and returns the current class instance.\n      @param {Function|String} [value]\n      @chainable\n   */\n  thresholdName(_) {\n    return arguments.length ? (this._thresholdName = typeof _ === \"function\" ? _ : constant(_), this) : this._thresholdName;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the time accessor to the specified function or string and returns the current class instance.\n      @param {Function|String} [*value*]\n      @chainable\n  */\n  time(_) {\n    if (arguments.length) {\n      if (typeof _ === \"function\") {\n        this._time = _;\n      }\n      else {\n        this._time = accessor(_);\n        if (!this._aggs[_]) {\n          this._aggs[_] = (a, c) => {\n            const v = unique(a.map(c));\n            return v.length === 1 ? v[0] : v;\n          };\n        }\n      }\n      this._timeFilter = false;\n      return this;\n    }\n    else return this._time;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the time filter to the specified function and returns the current class instance.\n      @param {Function} [*value*]\n      @chainable\n  */\n  timeFilter(_) {\n    return arguments.length ? (this._timeFilter = _, this) : this._timeFilter;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, toggles the timeline based on the specified boolean and returns the current class instance.\n      @param {Boolean} [*value* = true]\n      @chainable\n  */\n  timeline(_) {\n    return arguments.length ? (this._timeline = _, this) : this._timeline;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for the timeline and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  timelineConfig(_) {\n    return arguments.length ? (this._timelineConfig = assign(this._timelineConfig, _), this) : this._timelineConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc Tells the timeline whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the timeline appears centered underneath the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.\n      @param {Boolean|Function} [*value*]\n      @chainable\n  */\n  timelinePadding(_) {\n    return arguments.length ? (this._timelinePadding = typeof _ === \"function\" ? _ : constant(_), this) : this._timelinePadding;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the title accessor to the specified function or string and returns the current class instance.\n      @param {Function|String} [*value*]\n      @chainable\n  */\n  title(_) {\n    return arguments.length ? (this._title = typeof _ === \"function\" ? _ : constant(_), this) : this._title;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for the title and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  titleConfig(_) {\n    return arguments.length ? (this._titleConfig = assign(this._titleConfig, _), this) : this._titleConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc Tells the title whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the title appears centered above the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.\n      @param {Boolean|Function} [*value*]\n      @chainable\n  */\n  titlePadding(_) {\n    return arguments.length ? (this._titlePadding = typeof _ === \"function\" ? _ : constant(_), this) : this._titlePadding;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, toggles the tooltip based on the specified boolean and returns the current class instance.\n      @param {Boolean|Function} [*value* = true]\n      @chainable\n  */\n  tooltip(_) {\n    return arguments.length ? (this._tooltip = typeof _ === \"function\" ? _ : constant(_), this) : this._tooltip;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for the tooltip and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  tooltipConfig(_) {\n    return arguments.length ? (this._tooltipConfig = assign(this._tooltipConfig, _), this) : this._tooltipConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the total accessor to the specified function or string and returns the current class instance.\n      @param {Boolean|Function|String} [*value*]\n      @chainable\n  */\n  total(_) {\n    if (arguments.length) {\n      if (typeof _ === \"function\") this._total = _;\n      else if (_) this._total = accessor(_);\n      else this._total = false;\n      return this;\n    }\n    else return this._total;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the config method for the total and returns the current class instance.\n      @param {Object} [*value*]\n      @chainable\n  */\n  totalConfig(_) {\n    return arguments.length ? (this._totalConfig = assign(this._totalConfig, _), this) : this._totalConfig;\n  }\n\n  /**\n      @memberof Viz\n      @desc Formatter function for the value in the total bar.\n      @param {Function} *value*\n      @chainable\n  */\n  totalFormat(_) {\n    return arguments.length ? (this._totalFormat = _, this) : this._totalFormat;\n  }\n\n  /**\n      @memberof Viz\n      @desc Tells the total whether or not to use the internal padding defined by the visualization in it's positioning. For example, d3plus-plot will add padding on the left so that the total appears centered above the x-axis. By default, this padding is only applied on screens larger than 600 pixels wide.\n      @param {Boolean|Function} [*value*]\n      @chainable\n  */\n  totalPadding(_) {\n    return arguments.length ? (this._totalPadding = typeof _ === \"function\" ? _ : constant(_), this) : this._totalPadding;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the overallwidth to the specified number and returns the current class instance.\n      @param {Number} [*value* = window.innerWidth]\n      @chainable\n  */\n  width(_) {\n    return arguments.length ? (this._width = _, this) : this._width;\n  }\n\n  /**\n      @memberof Viz\n      @desc Toggles the ability to zoom/pan the visualization. Certain parameters for zooming are required to be hooked up on a visualization by visualization basis.\n      @param {Boolean} *value* = false\n      @chainable\n  */\n  zoom(_) {\n    return arguments.length ? (this._zoom = _, this) : this._zoom;\n  }\n\n  /**\n      @memberof Viz\n      @desc The pixel stroke-width of the zoom brush area.\n      @param {Number} *value* = 1\n      @chainable\n  */\n  zoomBrushHandleSize(_) {\n    return arguments.length ? (this._zoomBrushHandleSize = _, this) : this._zoomBrushHandleSize;\n  }\n\n  /**\n      @memberof Viz\n      @desc An object containing CSS key/value pairs that is used to style the outer handle area of the zoom brush. Passing `false` will remove all default styling.\n      @param {Object|Boolean} *value*\n      @chainable\n  */\n  zoomBrushHandleStyle(_) {\n    return arguments.length ? (this._zoomBrushHandleStyle = _, this) : this._zoomBrushHandleStyle;\n  }\n\n  /**\n      @memberof Viz\n      @desc An object containing CSS key/value pairs that is used to style the inner selection area of the zoom brush. Passing `false` will remove all default styling.\n      @param {Object|Boolean} *value*\n      @chainable\n  */\n  zoomBrushSelectionStyle(_) {\n    return arguments.length ? (this._zoomBrushSelectionStyle = _, this) : this._zoomBrushSelectionStyle;\n  }\n\n  /**\n      @memberof Viz\n      @desc An object containing CSS key/value pairs that is used to style each zoom control button (`.zoom-in`, `.zoom-out`, `.zoom-reset`, and `.zoom-brush`). Passing `false` will remove all default styling.\n      @param {Object|Boolean} *value*\n      @chainable\n  */\n  zoomControlStyle(_) {\n    return arguments.length ? (this._zoomControlStyle = _, this) : this._zoomControlStyle;\n  }\n\n  /**\n      @memberof Viz\n      @desc An object containing CSS key/value pairs that is used to style each zoom control button when active (`.zoom-in`, `.zoom-out`, `.zoom-reset`, and `.zoom-brush`). Passing `false` will remove all default styling.\n      @param {Object|Boolean} *value*\n      @chainable\n  */\n  zoomControlStyleActive(_) {\n    return arguments.length ? (this._zoomControlStyleActive = _, this) : this._zoomControlStyleActive;\n  }\n\n  /**\n      @memberof Viz\n      @desc An object containing CSS key/value pairs that is used to style each zoom control button on hover (`.zoom-in`, `.zoom-out`, `.zoom-reset`, and `.zoom-brush`). Passing `false` will remove all default styling.\n      @param {Object|Boolean} *value*\n      @chainable\n  */\n  zoomControlStyleHover(_) {\n    return arguments.length ? (this._zoomControlStyleHover = _, this) : this._zoomControlStyleHover;\n  }\n\n  /**\n      @memberof Viz\n      @desc The multiplier that is used in with the control buttons when zooming in and out.\n      @param {Number} *value* = 2\n      @chainable\n  */\n  zoomFactor(_) {\n    return arguments.length ? (this._zoomFactor = _, this) : this._zoomFactor;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, sets the max zoom scale to the specified number and returns the current class instance. If *value* is not specified, returns the current max zoom scale.\n      @param {Number} *value* = 16\n      @chainable\n  */\n  zoomMax(_) {\n    return arguments.length ? (this._zoomMax = _, this) : this._zoomMax;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, toggles panning to the specified boolean and returns the current class instance. If *value* is not specified, returns the current panning value.\n      @param {Boolean} *value* = true\n      @chainable\n  */\n  zoomPan(_) {\n    return arguments.length ? (this._zoomPan = _, this) : this._zoomPan;\n  }\n\n  /**\n      @memberof Viz\n      @desc A pixel value to be used to pad all sides of a zoomed area.\n      @param {Number} *value* = 20\n      @chainable\n  */\n  zoomPadding(_) {\n    return arguments.length ? (this._zoomPadding = _, this) : this._zoomPadding;\n  }\n\n  /**\n      @memberof Viz\n      @desc If *value* is specified, toggles scroll zooming to the specified boolean and returns the current class instance. If *value* is not specified, returns the current scroll zooming value.\n      @param {Boolean} [*value* = true]\n      @chainable\n  */\n  zoomScroll(_) {\n    return arguments.length ? (this._zoomScroll = _, this) : this._zoomScroll;\n  }\n\n}\n"],"names":["arrayOfArrays","data","reduce","acc","item","dataArray","Array","isArray","console","warn","concat","dataItem","url","headers","json","map","obj","header","i","path","formatter","key","callback","parser","getParser","ext","slice","length","csv","tsv","text","validateData","err","forEach","d","k","isNaN","parseFloat","toLowerCase","undefined","loadedLength","loadedArray","prev","current","getPathIndex","array","indexOf","needToLoad","find","isData","loaded","toLoad","ix","push","alreadyLoaded","request","hasOwnProperty","call","get","fold","_cache","_lrucache","set","formatterResponse","isObject","config","_","f","_queue","q","load","bind","Message","_isVisible","elem","duration","transition","style","remove","mask","exit","setTimeout","container","html","parent","select","selectAll","enter","append","attr","merge","stylize","String","visible","_history","backGroup","_select","_duration","update","transform","_margin","left","top","node","_backClass","_translate","x","y","_backConfig","render","fontSize","padding","_data","position","_colorScalePosition","includes","wide","_colorScalePadding","_padding","right","bottom","availableWidth","_width","width","min","_colorScaleMaxSize","availableHeight","_height","height","opacity","showColorScale","_colorScale","scaleGroup","condition","_colorScaleConfig","scaleData","filter","c","_colorScaleClass","align","locale","_locale","orient","value","scaleBounds","outerBounds","_legendClass","legendLabel","_drawLabel","_legendDepth","legendData","color","shape","_shape","_shapeConfig","fill","rollupData","rollup","leaves","_aggs","sort","_legendSort","labels","_ids","_drawDepth","values","l","some","v","from","Set","hidden","id","_id","_hidden","_solo","legendBounds","_legendPosition","_legendPadding","_legend","legendGroup","_legendConfig","direction","verticalAlign","shapeConfig","configPrep","_hiddenColor","labelConfig","fontOpacity","_hiddenOpacity","setTimeFilter","s","JSON","stringify","_timelineSelection","Number","timeFilter","ms","date","_time","getTime","timelinePossible","_timeline","ticks","unique","_timelinePadding","timelineGroup","timeline","_timelineClass","domain","extent","a","b","selection","_timelineConfig","on","end","_title","_titlePadding","group","_titleClass","_titleConfig","getBBox","total","_total","sum","_size","_totalPadding","_totalClass","_totalFormat","_totalConfig","_elementSize","element","tagName","val","window","charAt","toUpperCase","parentNode","buffer","pageX","pageXOffset","document","documentElement","body","scrollLeft","pageY","pageYOffset","scrollTop","bounds","getBoundingClientRect","innerHeight","innerWidth","_groupBy","filterGroup","filterId","hover","_tooltip","_tooltipClass","oldFilter","_filter","depth","_depth","event","hiddenIndex","soloIndex","dataLength","shiftKey","flattenIds","levels","arr","level","oldArray","hoverOpacity","filterIds","h","ids","_hover","tooltipData","tooltipDatum","__d3plus__","touches","clientX","clientY","t","footer","title","label","_tooltipConfig","_legendTooltip","preventDefault","stopPropagation","brushing","_container","_zoomGroup","_zoomHeight","that","_zoomWidth","_zoomBehavior","scaleExtent","_zoomMax","translateExtent","zoomed","_zoomToBounds","zoomToBounds","control","_zoom","controlEnter","zoomMath","_zoomFactor","classed","_zoomControlStyle","_zoomControlStyleActive","zoomEvents","_zoomControlStyleHover","_zoomBrush","button","detail","handleSize","_zoomBrushHandleSize","brushStart","brushBrush","brushEnd","brushGroup","_brushGroup","_renderTiles","zoomTransform","brush","_zoomScroll","_zoomPan","factor","center","translate0","Math","dx","dy","max","xMod","yMod","_zoomPadding","brushStyle","move","attrize","_zoomBrushSelectionStyle","_zoomBrushHandleStyle","_attribution","attrEnter","_attributionStyle","defaultPadding","listify","n","str","Viz","_ariaHidden","background","border","display","font","margin","TextBox","pop","resize","_color","ColorScale","scale","_dataCutoff","_detectResize","_detectResizeDelay","_detectVisible","_detectVisibleInterval","_downloadButton","_downloadConfig","type","_downloadPosition","constant","accessor","maxGrouped","Legend","ariaLabel","fontColor","fontResize","localeCompare","_loadingHTML","_loadingMessage","lrucache","_messageClass","_messageMask","_messageStyle","_noDataHTML","_noDataMessage","_on","clickShape","clickLegend","mouseenter","mouseleave","mousemoveShape","mousemoveLegend","_scrollContainer","_shapes","colors","range","colorAssign","colorContrast","stroke","darker","role","strokeWidth","_svgDesc","_svgTitle","Timeline","_threshold","_thresholdKey","_thresholdName","ariaHidden","textAnchor","Tooltip","pointerEvents","titleStyle","formatAbbreviate","zoom","cursor","g","_isAggregation","_label","reverse","ll","_timeFilter","dates","_discrete","latestTime","_filteredData","_legendData","flatData","nestKeys","tree","index","_thresholdFunction","uniqueIds","size","_userHover","_userDuration","legendPosition","colorScalePosition","drawLegend","drawColorScale","drawBack","drawTitle","drawTotal","drawTimeline","svg","setSVGSize","getSize","w","_autoWidth","_autoHeight","inViewport","_uuid","svgTitle","svgTitleEnter","svgDesc","svgDescEnter","_visiblePoll","clearInterval","_resizePoll","clearTimeout","_scrollPoll","setInterval","queue","p","cache","defer","_tasks","awaitAll","columns","Object","keys","svgTable","svgTableEnter","rows","cells","_preDraw","_draw","zoomControls","drawAttribution","hide","touchstartBody","_active","activeOpacity","active","arguments","assign","addToQueue","_groupByRaw","hoverFunction","shapeData","arrayMerge","activeData","activeIds","isFinite","BaseClass"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}